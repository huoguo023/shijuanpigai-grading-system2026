您说得对。这是因为在 SVG 中直接使用 `<text>` 标签包含换行符（`\n`）是无效的，浏览器会把它渲染成一行或者直接忽略，导致数据重叠或消失。

我重新编写了代码，重点**修复了第35题的SVG配图**，不再使用纯文本排版，而是通过**绘制表格线和独立文本块**的方式，确保数据清晰可见。

您可以直接复制以下完整代码覆盖原文件：

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.1 运动和力 - 全单元闯关测试</title>
    <style>
        :root {
            --primary: #3F51B5;
            --accent: #FF4081;
            --bg: #f0f2f5;
            --card: #ffffff;
            --text: #333;
            --success: #4CAF50;
            --error: #F44336;
        }

        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 50px; }
        
        /* Header & Layout */
        header { background: linear-gradient(135deg, var(--primary), #1A237E); color: white; padding: 2rem 1rem; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .container { max-width: 900px; margin: -30px auto 0; padding: 0 15px; position: relative; z-index: 2; }
        
        .section-title { border-left: 5px solid var(--accent); padding-left: 15px; margin: 40px 0 20px; font-size: 1.5rem; color: #444; }

        /* Cards */
        .card { background: var(--card); border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        
        /* --- Review Section (SVG Animations) --- */
        .demo-box { background: #e8eaf6; border-radius: 8px; padding: 15px; margin-top: 15px; text-align: center; border: 1px solid #c5cae9; }
        .demo-controls button { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px; }
        .demo-controls button:hover { background: #303F9F; }
        
        /* Car Simulation Styles */
        .sim-track { position: relative; height: 80px; background: #ddd; border-bottom: 4px solid #777; margin: 10px 0; overflow: hidden; }
        .sim-car { width: 50px; height: 25px; background: var(--accent); position: absolute; bottom: 0; left: 10px; border-radius: 5px 5px 0 0; transition: left 0.5s linear; }
        .sim-wheel { width: 10px; height: 10px; background: black; border-radius: 50%; position: absolute; bottom: -5px; }

        /* --- Quiz Section --- */
        .quiz-status { background: #333; color: white; padding: 15px; border-radius: 8px 8px 0 0; display: flex; justify-content: space-between; font-weight: bold; }
        
        .question-item { padding: 20px 0; border-bottom: 1px solid #eee; }
        .q-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; color: white; font-size: 0.75rem; margin-right: 8px; vertical-align: middle; }
        .badge-choice { background: #2196F3; }
        .badge-fill { background: #9C27B0; }
        .badge-drag { background: #FF9800; }
        .badge-exp { background: #E91E63; }
        
        .q-content { font-weight: 600; font-size: 1.05rem; display: inline; vertical-align: middle; }
        
        /* Form Inputs */
        .options label { display: block; padding: 8px 12px; margin: 5px 0; background: #f9f9f9; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .options label:hover { background: #e3f2fd; }
        .options input { margin-right: 10px; }
        
        input[type="text"] { border: 1px solid #ccc; padding: 8px; border-radius: 4px; width: 200px; }
        
        /* Drag & Drop Styles */
        .drag-container { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .drop-zone { flex: 1; min-width: 120px; border: 2px dashed #bbb; background: #fafafa; padding: 10px; border-radius: 6px; }
        .drop-zone h4 { margin: 0 0 8px 0; text-align: center; color: #666; font-size: 0.9rem; }
        .drag-pool { margin-top: 10px; padding: 10px; background: #eee; border-radius: 6px; display: flex; gap: 8px; flex-wrap: wrap; }
        .drag-item { background: white; padding: 5px 10px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; user-select: none; font-size: 0.9rem; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .drag-item.selected { border-color: var(--primary); background: #e8eaf6; box-shadow: 0 0 0 2px var(--primary); }

        /* Experiment Question Specifics */
        .exp-box { border: 2px solid #E91E63; border-radius: 8px; padding: 15px; margin-top: 15px; background: #fce4ec; }
        .exp-img-container { background: white; border: 1px solid #ddd; padding: 10px; text-align: center; margin-bottom: 15px; border-radius: 4px; }
        .exp-part { margin-bottom: 12px; }
        .exp-label { display: block; font-weight: bold; color: #880E4F; font-size: 0.9rem; margin-bottom: 4px; }
        textarea { width: 100%; height: 60px; border: 1px solid #ccc; border-radius: 4px; padding: 8px; font-family: inherit; resize: vertical; }

        /* Submit Button */
        .btn-submit { display: block; width: 100%; max-width: 300px; margin: 40px auto; padding: 15px; background: var(--success); color: white; border: none; border-radius: 50px; font-size: 1.2rem; cursor: pointer; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4); transition: transform 0.2s; }
        .btn-submit:hover { transform: scale(1.03); }

        /* Results Overlay */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; overflow-y: auto; }
        .modal-content { background: white; margin: 5vh auto; width: 90%; max-width: 800px; padding: 30px; border-radius: 12px; position: relative; }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 2rem; cursor: pointer; color: #999; }
        .score-display { text-align: center; font-size: 3rem; color: var(--primary); font-weight: bold; margin: 20px 0; }
        .analysis-card { background: #ffebee; border-left: 4px solid var(--error); padding: 15px; margin-bottom: 15px; }
        .analysis-card strong { display: block; margin-bottom: 5px; }
        .correct-answer { color: var(--success); font-weight: bold; margin-top: 5px; display: block; }
        
    </style>
</head>
<body>

<header>
    <h1>第三单元 第一课《运动和力》</h1>
    <p>复习演示 & 100分闯关测试</p>
</header>

<div class="container">

    <!-- PART 1: REVIEW SECTION -->
    <div class="section-title">一、 知识复习与演示</div>
    
    <div class="card">
        <h3>1. 重力 (Gravity)</h3>
        <p><strong>概念：</strong>由于地球的吸引而使物体受到的力叫重力。方向总是<strong>竖直向下</strong>。</p>
        <div class="demo-box">
            <svg viewBox="0 0 300 120" width="100%" height="120">
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#F44336" />
                    </marker>
                </defs>
                <!-- Tree & Apple -->
                <path d="M50,100 L50,60 Q30,40 50,20 Q70,40 50,60" fill="#4CAF50" stroke="none"/>
                <rect x="45" y="60" width="10" height="40" fill="#795548"/>
                <circle cx="65" cy="40" r="6" fill="red">
                    <animate attributeName="cy" from="40" to="100" dur="2s" repeatCount="indefinite" />
                </circle>
                <line x1="65" y1="46" x2="65" y2="70" stroke="#F44336" stroke-width="2" marker-end="url(#arrow)">
                     <animate attributeName="y1" from="46" to="106" dur="2s" repeatCount="indefinite" />
                     <animate attributeName="y2" from="70" to="130" dur="2s" repeatCount="indefinite" />
                </line>
                <text x="100" y="60" font-size="12" fill="#333">现象：苹果落地（受重力）</text>
                
                <!-- Slope -->
                <path d="M200,100 L280,100 L200,50 Z" fill="#FFCC80"/>
                <circle cx="210" cy="50" r="8" fill="#333">
                    <animateMotion path="M0,0 L80,50" dur="2s" repeatCount="indefinite" />
                </circle>
                <text x="220" y="30" font-size="12" fill="#333">现象：下滑（受重力分力）</text>
            </svg>
        </div>
    </div>

    <div class="card">
        <h3>2. 实验：小车运动与拉力</h3>
        <p><strong>原理：</strong>利用垫圈的重力作为动力。垫圈越多，重力越大，拉力越大，小车越快。</p>
        <div class="demo-box">
            <div class="sim-track">
                <div class="sim-car" id="sim-car">
                    <div class="sim-wheel" style="left:5px"></div>
                    <div class="sim-wheel" style="right:5px"></div>
                </div>
                <div style="position:absolute; right:0; top:30px; width:10px; height:10px; border:1px solid #333; border-radius:50%;"></div>
                <div style="position:absolute; right:5px; top:40px; width:1px; height:30px; background:#333;"></div>
                <div id="basket" style="position:absolute; right:0; top:70px; width:10px; height:10px; background:#555;"></div>
            </div>
            <div class="demo-controls">
                <button onclick="runSim(1)">挂1个垫圈 (不动)</button>
                <button onclick="runSim(3)">挂3个垫圈 (慢速)</button>
                <button onclick="runSim(8)">挂8个垫圈 (快速)</button>
            </div>
            <p id="sim-msg" style="font-weight:bold; color:#3F51B5; height:20px;"></p>
        </div>
    </div>

    <!-- PART 2: QUIZ SECTION -->
    <div class="section-title">二、 单元闯关塔 (35题 / 100分)</div>
    
    <div class="card">
        <div class="quiz-status">
            <span>共 35 题</span>
            <span>满分 100 分</span>
        </div>
        <form id="quiz-form">
            <!-- JS will inject questions here -->
        </form>
        <button type="button" class="btn-submit" onclick="submitQuiz()">提交试卷</button>
    </div>

</div>

<!-- Results Modal -->
<div id="result-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeResult()">&times;</span>
        <h2 style="text-align:center">测试结果</h2>
        <div class="score-display" id="final-score">0</div>
        <div id="analysis-content">
            <!-- Wrong answers injected here -->
        </div>
    </div>
</div>

<script>
// --- 1. Simulation Logic ---
function runSim(washers) {
    const car = document.getElementById('sim-car');
    const msg = document.getElementById('sim-msg');
    
    // Reset
    car.style.transition = 'none';
    car.style.left = '10px';
    
    setTimeout(() => {
        if (washers === 1) {
            msg.innerText = "拉力太小，无法克服摩擦力，小车静止。";
        } else {
            let duration = washers === 3 ? '2s' : '0.8s';
            let desc = washers === 3 ? '慢' : '快';
            car.style.transition = `left ${duration} linear`;
            car.style.left = '90%';
            msg.innerText = `拉力大 (${washers}个垫圈)，运动速度${desc}。`;
        }
    }, 100);
}

// --- 2. Question Database (35 Questions) ---
const questions = [
    // --- 选择题 (1-20) ---
    { id: 1, type: 'choice', q: '1. 苹果成熟后会掉下来，是因为受到了（ ）的作用。', opts: ['A. 弹力', 'B. 重力', 'C. 摩擦力'], ans: 'B', exp: '地球上的物体都受到重力作用，方向竖直向下。' },
    { id: 2, type: 'choice', q: '2. 重力的方向总是（ ）。', opts: ['A. 竖直向下', 'B. 垂直向上', 'C. 向四面八方'], ans: 'A', exp: '重力方向总是竖直向下指向地心。' },
    { id: 3, type: 'choice', q: '3. 在小车实验中，拉力的大小是用（ ）来表示的。', opts: ['A. 小车的重量', 'B. 垫圈的个数', 'C. 绳子的长度'], ans: 'B', exp: '垫圈数量越多，产生的重力越大，对小车的拉力就越大。' },
    { id: 4, type: 'choice', q: '4. 下列现象中，不属于重力作用的是（ ）。', opts: ['A. 水往低处流', 'B. 树叶飘落', 'C. 氢气球升空'], ans: 'C', exp: '氢气球升空是利用浮力大于重力，虽然受重力但主导现象是浮力上升。' },
    { id: 5, type: 'choice', q: '5. 使静止的小车运动起来，必须给它施加（ ）。', opts: ['A. 动力', 'B. 阻力', 'C. 颜色'], ans: 'A', exp: '力可以改变物体的运动状态，启动需要动力。' },
    { id: 6, type: 'choice', q: '6. 足球在草地上滚得越来越慢，是因为受到了（ ）。', opts: ['A. 重力', 'B. 摩擦力', 'C. 拉力'], ans: 'B', exp: '摩擦力阻碍物体运动，使速度变慢。' },
    { id: 7, type: 'choice', q: '7. 实验中，如果小车没动，应该（ ）。', opts: ['A. 推它一下', 'B. 增加垫圈', 'C. 减少垫圈'], ans: 'B', exp: '不动说明拉力小于摩擦力，需要增加垫圈增大拉力。' },
    { id: 8, type: 'choice', q: '8. 我们提水桶时觉得重，是因为水桶（ ）。', opts: ['A. 受到地球引力', 'B. 怕水洒出来', 'C. 不想被提起'], ans: 'A', exp: '提重物费力是因为要克服物体的重力。' },
    { id: 9, type: 'choice', q: '9. 假如没有重力，下列哪种情况不会发生？（ ）', opts: ['A. 人跳起来后回不到地面', 'B. 水杯里的水倒不出来', 'C. 河水往低处流'], ans: 'C', exp: '水往低处流是重力引起的，没有重力水会漂浮。' },
    { id: 10, type: 'choice', q: '10. 在一定限度内，挂的垫圈越多，小车运动得（ ）。', opts: ['A. 越慢', 'B. 越快', 'C. 一样快'], ans: 'B', exp: '拉力越大，加速度越大，运动越快。' },
    { id: 11, type: 'choice', q: '11. 实验时，小车运动的起点和终点（ ）。', opts: ['A. 每次都要保持一致', 'B. 可以随便定', 'C. 越远越好'], ans: 'A', exp: '控制变量法要求距离保持一致，以便比较时间。' },
    { id: 12, type: 'choice', q: '12. 每次实验我们至少要测量（ ）次。', opts: ['A. 1', 'B. 3', 'C. 5'], ans: 'B', exp: '测量3次取平均值可以减小误差。' },
    { id: 13, type: 'choice', q: '13. 安装小车绳子时，绳子长度应该（ ）。', opts: ['A. 越短越好', 'B. 越长越好', 'C. 适中，不能拖地'], ans: 'C', exp: '太长拖地会产生摩擦力，太短小车跑不完全程。' },
    { id: 14, type: 'choice', q: '14. 下列物体中，质量最大的是（ ），受到的重力也最大。', opts: ['A. 乒乓球', 'B. 篮球', 'C. 铅球'], ans: 'C', exp: '同体积下铅球质量最大，质量越大重力越大。' },
    { id: 15, type: 'choice', q: '15. 力的单位是（ ）。', opts: ['A. 牛顿', 'B. 千克', 'C. 米'], ans: 'A', exp: '科学上力的单位是牛顿，简称牛(N)。' },
    { id: 16, type: 'choice', q: '16. 下垫圈时，应该（ ）。', opts: ['A. 一个个增加', 'B. 一把扔进去', 'C. 随便放'], ans: 'A', exp: '逐个增加能准确找到启动的最小拉力。' },
    { id: 17, type: 'choice', q: '17. 垫圈对小车的拉力与小车受到的摩擦力方向（ ）。', opts: ['A. 相同', 'B. 相反', 'C. 垂直'], ans: 'B', exp: '动力与阻力方向通常是相反的。' },
    { id: 18, type: 'choice', q: '18. 运动员踢足球，体现了（ ）。', opts: ['A. 力能改变物体形状', 'B. 力能改变物体运动状态', 'C. 力能消失'], ans: 'B', exp: '球由静止变运动，或改变方向，是运动状态改变。' },
    { id: 19, type: 'choice', q: '19. 计时器是用来测量（ ）的。', opts: ['A. 拉力大小', 'B. 运动距离', 'C. 运动时间'], ans: 'C', exp: '秒表/计时器测量时间。' },
    { id: 20, type: 'choice', q: '20. 小车从启动到停止，能量转化主要是（ ）。', opts: ['A. 势能转动能', 'B. 电能转动能', 'C. 热能转光能'], ans: 'A', exp: '垫圈的重力势能转化为小车的动能。' },

    // --- 填空题 (21-30) ---
    { id: 21, type: 'fill', q: '21. 由于地球的吸引而使物体受到的力叫____。', ans: '重力', exp: '定义：地球引力产生的力叫重力。' },
    { id: 22, type: 'fill', q: '22. 树上的苹果掉下来，瀑布飞流直下，都是因为受到____的作用。', ans: '重力', exp: '重力导致物体向下运动。' },
    { id: 23, type: 'fill', q: '23. 我们提水感到费力，是因为水桶对手有向下的____力。', ans: '拉', exp: '重力通过提手表现为向下的拉力。' },
    { id: 24, type: 'fill', q: '24. 实验中，垫圈的数量越多，小车受到的拉力越____。', ans: '大', exp: '垫圈越多，总重力越大，拉力越大。' },
    { id: 25, type: 'fill', q: '25. 物体的____越大，受到的重力就越大。', ans: '质量', exp: '重力大小与质量成正比。' },
    { id: 26, type: 'fill', q: '26. 拉力越大，小车运动得越____。', ans: '快', exp: '力越大，运动速度越快。' },
    { id: 27, type: 'fill', q: '27. 要使静止的小车运动起来，需要给他施加____。', ans: '动力', exp: '动力克服阻力使物体运动。' },
    { id: 28, type: 'fill', q: '28. 实验时，我们用秒表测量小车运动的____。', ans: '时间', exp: '快慢通过相同距离所需的时间来衡量。' },
    { id: 29, type: 'fill', q: '29. 阻碍物体运动的力叫做____。', ans: '摩擦力', exp: '与运动方向相反的阻力通常是摩擦力。' },
    { id: 30, type: 'fill', q: '30. 重力的方向总是____向下的。', ans: '竖直', exp: '垂直于水平面，指向地心。' },

    // --- 拖拽题 (31-33) ---
    { 
        id: 31, type: 'drag', q: '31. 请将下列物体按“受力来源”分类：',
        cats: ['重力现象', '弹力现象(干扰)'],
        items: [
            {t:'苹果落地', c:0}, {t:'拉开弓箭', c:1}, {t:'水往低处流', c:0}, {t:'高空坠物', c:0}
        ],
        exp: '苹果、流水、坠物都是重力引起；弓箭是弹力。'
    },
    { 
        id: 32, type: 'drag', q: '32. 请给实验步骤排序：',
        cats: ['步骤1', '步骤2', '步骤3'],
        items: [
            {t:'标出起点终点', c:0}, {t:'逐个增加垫圈', c:1}, {t:'记录时间数据', c:2}
        ],
        exp: '先定距离，再做操作，最后记数据。'
    },
    { 
        id: 33, type: 'drag', q: '33. 判断小车状态与拉力关系：',
        cats: ['拉力<摩擦力', '拉力>摩擦力'],
        items: [
            {t:'小车静止不动', c:0}, {t:'小车开始运动', c:1}, {t:'小车加速冲刺', c:1}
        ],
        exp: '拉力必须大于摩擦力小车才会动。'
    },

    // --- 实验探究题 (34-35) ---
    {
        id: 34, type: 'experiment', 
        q: '34. 观察“小车运动快慢与拉力大小关系”的实验装置图，回答问题。',
        svg: `<svg viewBox="0 0 300 100" style="background:white; border:1px solid #ddd">
                <rect x="20" y="50" width="260" height="5" fill="#bbb"/>
                <rect x="40" y="30" width="40" height="20" fill="#FF4081" rx="5"/>
                <line x1="80" y1="40" x2="280" y2="40" stroke="#333"/>
                <circle cx="280" cy="40" r="5" fill="#fff" stroke="#333"/>
                <line x1="285" y1="40" x2="285" y2="80" stroke="#333"/>
                <rect x="280" y="80" width="10" height="15" fill="#333"/>
                <text x="100" y="20" font-size="12">小车</text>
                <text x="250" y="90" font-size="12">垫圈</text>
              </svg>`,
        sub: [
            { label: '1. 【填空】实验中，小车的动力是由____提供的。', ans: '垫圈重力' },
            { label: '2. 【分析】为什么实验中垫圈要一个一个地增加？', ans: '准确', key: ['准确', '最小', '开始', '阈值'] },
            { label: '3. 【原理】说明拉力大小与小车运动状态的关系。', ans: '力改变运动', key: ['力', '大', '快', '改变'] }
        ],
        exp: '1.动力来自垫圈重力；2.逐个增加是为了找到刚好克服摩擦力的最小拉力；3.原理：力能改变物体的运动状态，拉力越大，速度越快。'
    },
    {
        id: 35, type: 'experiment', 
        q: '35. 下表是某小组的实验记录，请分析数据并得出结论。',
        // FIXED: SVG with explicit lines and text for table display
        svg: `<svg viewBox="0 0 300 150" style="background:white; border:1px solid #ddd">
                <!-- Header -->
                <rect x="0" y="0" width="300" height="40" fill="#eee"/>
                <text x="80" y="25" font-size="14" text-anchor="middle" font-weight="bold">垫圈数(个)</text>
                <text x="220" y="25" font-size="14" text-anchor="middle" font-weight="bold">运动时间(秒)</text>
                <!-- Row 1 -->
                <line x1="0" y1="40" x2="300" y2="40" stroke="#ccc"/>
                <text x="80" y="65" font-size="14" text-anchor="middle">2</text>
                <text x="220" y="65" font-size="14" text-anchor="middle">5.5</text>
                <!-- Row 2 -->
                <line x1="0" y1="80" x2="300" y2="80" stroke="#ccc"/>
                <text x="80" y="105" font-size="14" text-anchor="middle">4</text>
                <text x="220" y="105" font-size="14" text-anchor="middle">3.2</text>
                <!-- Row 3 -->
                <line x1="0" y1="120" x2="300" y2="120" stroke="#ccc"/>
                <text x="80" y="140" font-size="14" text-anchor="middle">8</text>
                <text x="220" y="140" font-size="14" text-anchor="middle">1.5</text>
                <!-- Vertical Line -->
                <line x1="150" y1="0" x2="150" y2="150" stroke="#ccc"/>
              </svg>`,
        sub: [
            { label: '1. 【填空】根据数据，挂8个垫圈时，小车运动最____。', ans: '快' },
            { label: '2. 【分析】比较2个和4个垫圈的数据，你发现了什么规律？', ans: '垫圈多时间短', key: ['多', '短', '快'] },
            { label: '3. 【原理】请总结本实验的科学结论。', ans: '拉力越大运动越快', key: ['拉力', '大', '快', '速度'] }
        ],
        exp: '1.时间最短即最快；2.数据表明垫圈增加时间减少；3.结论：拉力越大，小车运动越快。'
    }
];

// --- 3. Quiz Rendering Logic ---
const form = document.getElementById('quiz-form');

function renderQuiz() {
    questions.forEach(q => {
        const div = document.createElement('div');
        div.className = 'question-item';
        div.id = `q-${q.id}`;
        
        // Badge
        let badgeClass = '';
        let badgeText = '';
        if(q.type === 'choice') { badgeClass = 'badge-choice'; badgeText = '选择题 (2分)'; }
        if(q.type === 'fill') { badgeClass = 'badge-fill'; badgeText = '填空题 (2分)'; }
        if(q.type === 'drag') { badgeClass = 'badge-drag'; badgeText = '拖拽题 (5分)'; }
        if(q.type === 'experiment') { badgeClass = 'badge-exp'; badgeText = '实验探究 (12.5分)'; }
        
        let html = `<div><span class="q-badge ${badgeClass}">${badgeText}</span><div class="q-content">${q.q}</div></div>`;

        // Input Generation
        if (q.type === 'choice') {
            html += `<div class="options">`;
            q.opts.forEach(opt => {
                html += `<label><input type="radio" name="q${q.id}" value="${opt[0]}"> ${opt}</label>`;
            });
            html += `</div>`;
        } else if (q.type === 'fill') {
            html += `<div style="margin-top:10px"><input type="text" name="q${q.id}" placeholder="请输入答案"></div>`;
        } else if (q.type === 'drag') {
            html += `<div class="drag-container">`;
            q.cats.forEach((cat, idx) => {
                html += `<div class="drop-zone" ondrop="drop(event, ${q.id}, ${idx})" ondragover="allowDrop(event)"><h4>${cat}</h4><div class="zone-items" id="zone-${q.id}-${idx}"></div></div>`;
            });
            html += `</div><div class="drag-pool">`;
            q.items.forEach((item, idx) => {
                html += `<div class="drag-item" id="d-${q.id}-${idx}" draggable="true" ondragstart="drag(event, ${q.id}, ${idx})" onclick="clickDrag(this, ${q.id}, ${idx})">${item.t}</div>`;
            });
            html += `</div><input type="hidden" id="inp-q${q.id}">`;
        } else if (q.type === 'experiment') {
            html += `<div class="exp-box">`;
            html += `<div class="exp-img-container">${q.svg}</div>`;
            q.sub.forEach((sub, idx) => {
                html += `<div class="exp-part"><span class="exp-label">${sub.label}</span>`;
                if(sub.label.includes('填空')) {
                    html += `<input type="text" name="q${q.id}_s${idx}" placeholder="简短回答">`;
                } else {
                    html += `<textarea name="q${q.id}_s${idx}" placeholder="请详细说明..."></textarea>`;
                }
                html += `</div>`;
            });
            html += `</div>`;
        }

        div.innerHTML = html;
        form.appendChild(div);
    });
}

// --- 4. Drag & Drop Helpers (Mobile Friendly Click) ---
let selectedDrag = null;
function allowDrop(ev) { ev.preventDefault(); }
function drag(ev, qid, iidx) { ev.dataTransfer.setData("qid", qid); ev.dataTransfer.setData("iidx", iidx); }
function drop(ev, qid, zidx) {
    ev.preventDefault();
    const iidx = ev.dataTransfer.getData("iidx");
    const item = document.getElementById(`d-${qid}-${iidx}`);
    if(item) appendItem(item, qid, zidx);
}
function clickDrag(el, qid, iidx) {
    if(selectedDrag && selectedDrag === el) {
        el.classList.remove('selected'); selectedDrag = null; return;
    }
    if(selectedDrag) selectedDrag.classList.remove('selected');
    selectedDrag = el;
    el.classList.add('selected');
    // Highlight zones logic could go here
    const zones = document.querySelectorAll(`#q-${qid} .drop-zone`);
    zones.forEach((z, idx) => {
        z.onclick = () => { if(selectedDrag) { appendItem(selectedDrag, qid, idx); selectedDrag=null; } };
    });
}
function appendItem(item, qid, zidx) {
    document.getElementById(`zone-${qid}-${zidx}`).appendChild(item);
    item.classList.remove('selected');
    updateDragInput(qid);
}
function updateDragInput(qid) {
    let res = [];
    const zones = document.querySelectorAll(`#q-${qid} .drop-zone`);
    zones.forEach((z, zidx) => {
        const items = z.querySelectorAll('.drag-item');
        items.forEach(i => {
            // format: itemIndex:zoneIndex
            const iidx = i.id.split('-')[2];
            res.push(`${iidx}:${zidx}`);
        });
    });
    document.getElementById(`inp-q${qid}`).value = res.join(',');
}

// --- 5. Scoring Logic ---
function submitQuiz() {
    let score = 0;
    let html = '';
    
    questions.forEach(q => {
        let correct = false;
        let userAns = '';
        let points = 0;
        
        if(q.type === 'choice') {
            const el = document.querySelector(`input[name="q${q.id}"]:checked`);
            if(el) userAns = el.value;
            if(userAns === q.ans) { correct = true; score += 2; }
        } 
        else if (q.type === 'fill') {
            const el = document.querySelector(`input[name="q${q.id}"]`);
            userAns = el.value.trim();
            if(userAns.includes(q.ans)) { correct = true; score += 2; }
        }
        else if (q.type === 'drag') {
            const raw = document.getElementById(`inp-q${q.id}`).value;
            if(raw) {
                const pairs = raw.split(',');
                let allRight = true;
                let count = 0;
                pairs.forEach(p => {
                    const [i, z] = p.split(':');
                    if(q.items[i].c != z) allRight = false;
                    count++;
                });
                if(count === q.items.length && allRight) { correct = true; score += 5; }
            }
        }
        else if (q.type === 'experiment') {
            // Complex partial scoring
            let subPoints = 0;
            let subCorrectCount = 0;
            q.sub.forEach((sub, idx) => {
                const el = document.querySelector(`[name="q${q.id}_s${idx}"]`);
                const val = el.value.trim();
                let isPartRight = false;
                if(sub.label.includes('填空')) {
                    if(val.includes(sub.ans)) isPartRight = true;
                } else {
                    // Check for keywords
                    if(sub.key && sub.key.some(k => val.includes(k))) isPartRight = true;
                }
                if(isPartRight) { subPoints += 4.16; subCorrectCount++; } // approx 12.5 total
            });
            if(subCorrectCount === 3) { correct = true; score += 12.5; }
            else score += Math.floor(subPoints); // Partial credit
        }

        if(!correct) {
            html += `<div class="analysis-card">
                <strong>第 ${q.id} 题 (${q.type === 'experiment' ? '实验探究' : '基础知识'}) 错误</strong>
                <div>${q.q}</div>
                <span class="correct-answer">解析：${q.exp}</span>
            </div>`;
        }
    });

    // Final Score Cap at 100 just in case of float rounding
    score = Math.min(100, Math.round(score));
    
    document.getElementById('final-score').innerText = score;
    document.getElementById('analysis-content').innerHTML = html || '<div style="text-align:center; color:green">太棒了！全部正确！</div>';
    document.getElementById('result-modal').style.display = 'block';
}

function closeResult() {
    document.getElementById('result-modal').style.display = 'none';
}

// Init
renderQuiz();

</script>
</body>
</html>
```