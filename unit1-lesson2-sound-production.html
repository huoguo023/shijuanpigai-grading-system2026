<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬äºŒè¯¾ï¼šå£°éŸ³æ˜¯æ€æ ·äº§ç”Ÿçš„ - å®éªŒä¸é—¯å…³</title>
    <style>
        :root {
            --bg-color: #E0F2F1; /* æµ…é’è‰²èƒŒæ™¯ */
            --card-bg: #FFFFFF;
            --primary: #009688; /* è“ç»¿è‰²ä¸»è°ƒ */
            --secondary: #FF7043; /* æ´»åŠ›æ©™ */
            --text: #37474F;
            --font-main: "Microsoft YaHei", -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            display: block;
            background-image: radial-gradient(#80CBC4 10%, transparent 11%);
            background-size: 20px 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            border: 4px solid #B2DFDB;
            overflow: hidden;
        }

        h1 { color: #00796B; margin-top: 0; font-size: 1.6em; margin-bottom: 5px; }
        .subtitle { color: #FF7043; font-size: 1em; margin-bottom: 15px; font-weight: bold; }

        /* åŒºåŸŸåˆ‡æ¢ */
        .section { display: none; animation: fadeIn 0.3s ease-out; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* çŸ¥è¯†ç‚¹å¡ç‰‡ */
        .knowledge-box {
            background: #E0F2F1;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            border-left: 5px solid #009688;
            margin-bottom: 20px;
        }
        .knowledge-box h3 { margin: 0 0 10px 0; color: #00695C; border-bottom: 1px dashed #B2DFDB; padding-bottom: 5px; }
        .k-point { margin-bottom: 10px; font-size: 1em; line-height: 1.5; }
        .highlight { color: #D84315; font-weight: bold; }

        /* SVG å®éªŒå° */
        .experiment-stage {
            background: #FFF;
            border: 2px dashed #FFB74D;
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
        }
        .exp-caption { font-size: 0.9em; color: #777; margin-top: 5px; }

        /* æŒ‰é’® */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 0;
            width: 100%;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: bold;
            box-shadow: 0 4px 0 #00695C;
        }
        .btn:active { transform: translateY(3px); box-shadow: 0 1px 0 #00695C; }
        .btn-next { background: #FF7043; box-shadow: 0 4px 0 #D84315; }

        /* é¢˜ç›®åŒºåŸŸ */
        .progress-bar-container { width: 100%; height: 10px; background: #ECEFF1; border-radius: 5px; margin-bottom: 5px; overflow: hidden; }
        .progress-bar { height: 100%; background: #26A69A; width: 0%; transition: width 0.3s; }
        
        .question-card { background: #FAFAFA; border-radius: 10px; padding: 15px; text-align: left; border: 2px solid #EEE; margin-top: 10px; }
        .q-tag { background: #E0F2F1; color: #00796B; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; margin-right: 5px; }
        .q-content { font-size: 1.2em; font-weight: bold; margin: 10px 0 20px 0; line-height: 1.4; }

        /* é€‰é¡¹ & è¿çº¿ */
        .option-item {
            background: white; border: 2px solid #CFD8DC; padding: 12px; border-radius: 8px;
            margin-bottom: 10px; cursor: pointer; transition: 0.2s;
        }
        .option-item.selected { background: #B2DFDB; border-color: #009688; font-weight: bold; }

        .fill-input { border: none; border-bottom: 3px solid #009688; background: transparent; width: 100px; text-align: center; font-size: 1.2em; color: #D84315; border-radius: 0; }
        
        /* è¿çº¿é¢˜æ ·å¼ */
        .match-container { display: flex; justify-content: space-between; gap: 10px; }
        .match-col { width: 48%; display: flex; flex-direction: column; gap: 8px; }
        .match-btn { 
            padding: 10px; background: #FFF; border: 2px solid #90A4AE; 
            border-radius: 8px; font-size: 0.9em; text-align: center; cursor: pointer; 
        }
        .match-btn.selected { background: #FFF9C4; border-color: #FBC02D; transform: scale(1.02); }
        .match-btn.matched { background: #C8E6C9; border-color: #43A047; opacity: 0.6; pointer-events: none; }

        /* é”™é¢˜æœ¬ */
        .wrong-item { background: #FFEBEE; border-left: 4px solid #EF5350; padding: 10px; margin-bottom: 10px; text-align: left; border-radius: 4px; }
        .score-display { font-size: 3.5em; color: #FF7043; font-weight: bold; margin: 10px 0; }

    </style>
</head>
<body>

    <!-- å³æ—¶åé¦ˆç³»ç»Ÿæ ·å¼ -->
    <style>
    .feedback-toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px); background: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 8px 30px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 12px; z-index: 10000; opacity: 0; transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55); font-size: 1.1rem; font-weight: bold; }
    .feedback-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
    .feedback-success { border: 3px solid #4CAF50; color: #2E7D32; }
    .feedback-error { border: 3px solid #FF9800; color: #E65100; }
    .toast-icon { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: bold; }
    .feedback-success .toast-icon { background: #4CAF50; color: white; }
    .feedback-error .toast-icon { background: #FF9800; color: white; }
    .confetti { position: fixed; width: 10px; height: 10px; z-index: 9999; pointer-events: none; }
    @keyframes confetti-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    @keyframes correct-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); } 20%, 40%, 60%, 80% { transform: translateX(8px); } }
    .option-item.correct-feedback { animation: correct-pulse 0.6s; background: #E8F5E9 !important; border-color: #4CAF50 !important; box-shadow: 0 0 20px rgba(76, 175, 80, 0.3) !important; }
    .option-item.wrong-feedback { animation: shake 0.5s; background: #FFF3E0 !important; border-color: #FF9800 !important; }
    .fill-input.correct-feedback { animation: correct-pulse 0.6s; background: #E8F5E9 !important; border-color: #4CAF50 !important; }
    .fill-input.wrong-feedback { animation: shake 0.5s; background: #FFF3E0 !important; border-color: #FF9800 !important; }
    </style>

    <!-- 1. å¤ä¹ åŒº -->
    <div id="section-review" class="container section active">
        <h1>ğŸ”¬ çŸ¥è¯†å¤ä¹ </h1>
        <p class="subtitle">ç¬¬äºŒè¯¾ï¼šå£°éŸ³æ˜¯æ€æ ·äº§ç”Ÿçš„</p>

        <!-- å®éªŒ1ï¼šçš®ç­‹å®éªŒ -->
        <div class="knowledge-box">
            <h3>ğŸ§ª å®éªŒ1ï¼šçš®ç­‹å‘å£°çš„ç§˜å¯†</h3>
            <div class="k-point">âŒ <strong>ä¸å‘å£°</strong>ï¼šæ‹‰ä¼¸ã€æŒ‰å‹ã€æ‰æ“çš®ç­‹ï¼ˆçš®ç­‹æ²¡æœ‰æŒ¯åŠ¨ï¼‰ã€‚</div>
            <div class="k-point">âœ… <strong>å‘å£°</strong>ï¼šè½»è½»å¼¹æ‹¨ã€æ¨ªå‘æ‹‰åŠ¨ï¼ˆçš®ç­‹åœ¨<span class="highlight">æŒ¯åŠ¨</span>ï¼‰ã€‚</div>
            
            <div class="experiment-stage">
                <svg width="100%" height="140" viewBox="0 0 350 140" style="background:linear-gradient(to bottom, #FFF3E0 0%, #F5F5F5 100%); border-radius:10px;">
                    <defs>
                        <linearGradient id="handGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#FFCCBC"/>
                            <stop offset="100%" style="stop-color:#FF8A65"/>
                        </linearGradient>
                        <linearGradient id="bandGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#EF5350"/>
                            <stop offset="50%" style="stop-color:#F44336"/>
                            <stop offset="100%" style="stop-color:#EF5350"/>
                        </linearGradient>
                    </defs>
                    
                    <!-- æ ‡é¢˜ -->
                    <text x="175" y="18" text-anchor="middle" font-size="13" fill="#E65100" font-weight="bold">çš®ç­‹æŒ¯åŠ¨å®éªŒå¯¹æ¯”</text>
                    
                    <!-- å·¦ï¼šé™æ­¢çš®ç­‹ -->
                    <g transform="translate(0, 30)">
                        <text x="85" y="0" text-anchor="middle" font-size="12" fill="#666" font-weight="bold">âŒ æ‹‰ä¼¸ï¼ˆä¸å‘å£°ï¼‰</text>
                        
                        <!-- å·¦æ‰‹ -->
                        <rect x="25" y="20" width="15" height="70" fill="url(#handGrad)" stroke="#D84315" stroke-width="2" rx="7"/>
                        <ellipse cx="32.5" cy="20" rx="7.5" ry="4" fill="#FFAB91"/>
                        <line x1="28" y1="30" x2="28" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="32" y1="30" x2="32" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="36" y1="30" x2="36" y2="50" stroke="#FF7043" stroke-width="1"/>
                        
                        <!-- å³æ‰‹ -->
                        <rect x="130" y="20" width="15" height="70" fill="url(#handGrad)" stroke="#D84315" stroke-width="2" rx="7"/>
                        <ellipse cx="137.5" cy="20" rx="7.5" ry="4" fill="#FFAB91"/>
                        <line x1="133" y1="30" x2="133" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="137" y1="30" x2="137" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="141" y1="30" x2="141" y2="50" stroke="#FF7043" stroke-width="1"/>
                        
                        <!-- é™æ­¢çš„çš®ç­‹ -->
                        <line x1="40" y1="55" x2="130" y2="55" stroke="url(#bandGrad)" stroke-width="5" stroke-linecap="round"/>
                        <ellipse cx="85" cy="55" rx="3" ry="2" fill="#FFCDD2" opacity="0.6"/>
                        
                        <text x="85" y="105" text-anchor="middle" font-size="10" fill="#999">çš®ç­‹é™æ­¢ â†’ æ— æŒ¯åŠ¨ â†’ æ— å£°éŸ³</text>
                    </g>

                    <!-- å³ï¼šæŒ¯åŠ¨çš®ç­‹ -->
                    <g transform="translate(175, 30)">
                        <text x="85" y="0" text-anchor="middle" font-size="12" fill="#2E7D32" font-weight="bold">âœ… å¼¹æ‹¨ï¼ˆå‘å£°ï¼‰</text>
                        
                        <!-- å·¦æ‰‹ -->
                        <rect x="25" y="20" width="15" height="70" fill="url(#handGrad)" stroke="#D84315" stroke-width="2" rx="7"/>
                        <ellipse cx="32.5" cy="20" rx="7.5" ry="4" fill="#FFAB91"/>
                        <line x1="28" y1="30" x2="28" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="32" y1="30" x2="32" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="36" y1="30" x2="36" y2="50" stroke="#FF7043" stroke-width="1"/>
                        
                        <!-- å³æ‰‹ -->
                        <rect x="130" y="20" width="15" height="70" fill="url(#handGrad)" stroke="#D84315" stroke-width="2" rx="7"/>
                        <ellipse cx="137.5" cy="20" rx="7.5" ry="4" fill="#FFAB91"/>
                        <line x1="133" y1="30" x2="133" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="137" y1="30" x2="137" y2="50" stroke="#FF7043" stroke-width="1"/>
                        <line x1="141" y1="30" x2="141" y2="50" stroke="#FF7043" stroke-width="1"/>
                        
                        <!-- æŒ¯åŠ¨çš„çš®ç­‹ -->
                        <path d="M40,55 Q85,55 130,55" stroke="url(#bandGrad)" stroke-width="5" fill="none" stroke-linecap="round">
                            <animate attributeName="d" 
                                values="M40,55 Q85,25 130,55; M40,55 Q85,85 130,55; M40,55 Q85,25 130,55" 
                                dur="0.15s" repeatCount="indefinite"/>
                        </path>
                        
                        <!-- å£°æ³¢ -->
                        <g opacity="0.7">
                            <path d="M85,55 Q95,45 105,55 Q115,65 125,55" stroke="#4CAF50" stroke-width="2" fill="none">
                                <animate attributeName="opacity" values="0.7;0;0.7" dur="0.3s" repeatCount="indefinite"/>
                            </path>
                            <path d="M85,55 Q95,40 105,55 Q115,70 125,55" stroke="#66BB6A" stroke-width="1.5" fill="none">
                                <animate attributeName="opacity" values="0.5;0;0.5" dur="0.3s" begin="0.1s" repeatCount="indefinite"/>
                            </path>
                        </g>
                        
                        <!-- éŸ³ç¬¦ -->
                        <text x="150" y="45" font-size="20">ğŸµ</text>
                        <text x="150" y="70" font-size="16">ğŸ¶</text>
                        
                        <text x="85" y="105" text-anchor="middle" font-size="10" fill="#2E7D32" font-weight="bold">çš®ç­‹æŒ¯åŠ¨ â†’ äº§ç”Ÿå£°æ³¢ â†’ å‘å‡ºå£°éŸ³</text>
                    </g>
                </svg>
                <div class="exp-caption">å¯¹æ¯”ï¼šé™æ­¢çš„çš®ç­‹ vs æŒ¯åŠ¨çš„çš®ç­‹</div>
            </div>
        </div>

        <!-- å®éªŒ2ï¼šæ„Ÿå—æŒ¯åŠ¨ -->
        <div class="knowledge-box">
            <h3>ğŸ§ª å®éªŒ2ï¼šå£°éŸ³æ˜¯ç”±æŒ¯åŠ¨äº§ç”Ÿçš„</h3>
            <div class="k-point">ğŸ‘‰ ç”¨æ‰‹è§¦æ‘¸æ­£åœ¨å‘å£°çš„é’¢å°ºã€é¼“é¢ã€éŸ³å‰ï¼Œä¼šæ„Ÿè§‰åˆ°<span class="highlight">éº»éº»çš„æŒ¯åŠ¨</span>ã€‚</div>
            <div class="k-point">ğŸ›‘ å¦‚æœç‰©ä½“åœæ­¢æŒ¯åŠ¨ï¼Œå£°éŸ³ä¹Ÿä¼š<span class="highlight">ç«‹å³åœæ­¢</span>ã€‚</div>

            <div class="experiment-stage">
                <svg width="100%" height="130" viewBox="0 0 320 130" style="background:linear-gradient(to bottom, #FFEBEE 0%, #F5F5F5 100%); border-radius:10px;">
                    <defs>
                        <linearGradient id="drumGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#FFE0B2"/>
                            <stop offset="100%" style="stop-color:#FFCC80"/>
                        </linearGradient>
                        <linearGradient id="drumBodyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#FFE0B2"/>
                            <stop offset="50%" style="stop-color:#FFCC80"/>
                            <stop offset="100%" style="stop-color:#FFB74D"/>
                        </linearGradient>
                        <radialGradient id="stickGrad">
                            <stop offset="0%" style="stop-color:#8D6E63"/>
                            <stop offset="100%" style="stop-color:#5D4037"/>
                        </radialGradient>
                    </defs>
                    
                    <!-- æ ‡é¢˜ -->
                    <text x="160" y="18" text-anchor="middle" font-size="13" fill="#D84315" font-weight="bold">é¼“é¢æŒ¯åŠ¨å®éªŒ</text>
                    
                    <!-- é¼“ -->
                    <g transform="translate(160, 70)">
                        <!-- é¼“é¢ï¼ˆä¸Šï¼‰ -->
                        <ellipse cx="0" cy="0" rx="70" ry="22" fill="url(#drumGrad)" stroke="#EF6C00" stroke-width="2.5"/>
                        <ellipse cx="0" cy="0" rx="60" ry="18" fill="#FFF3E0" opacity="0.3"/>
                        
                        <!-- é¼“èº« -->
                        <path d="M-70,0 L-70,35 Q0,50 70,35 L70,0" fill="url(#drumBodyGrad)" stroke="#EF6C00" stroke-width="2"/>
                        <ellipse cx="0" cy="35" rx="70" ry="22" fill="#FFB74D" stroke="#EF6C00" stroke-width="2"/>
                        
                        <!-- é¼“é¢çº¹ç† -->
                        <circle cx="0" cy="0" r="50" fill="none" stroke="#FFB74D" stroke-width="1" opacity="0.3"/>
                        <circle cx="0" cy="0" r="35" fill="none" stroke="#FFB74D" stroke-width="1" opacity="0.3"/>
                        
                        <!-- é¼“æ§Œ -->
                        <g>
                            <line x1="-40" y1="-40" x2="-10" y2="-5" stroke="url(#stickGrad)" stroke-width="4" stroke-linecap="round">
                                <animateTransform attributeName="transform" type="rotate" 
                                    values="0 -10 -5; -15 -10 -5; 0 -10 -5" 
                                    dur="0.6s" repeatCount="indefinite"/>
                            </line>
                            <ellipse cx="-10" cy="-5" rx="8" ry="6" fill="#5D4037">
                                <animate attributeName="cy" values="-5; 0; -5" dur="0.6s" repeatCount="indefinite"/>
                            </ellipse>
                        </g>

                        <!-- æŒ¯åŠ¨æ³¢çº¹ï¼ˆå¤šå±‚ï¼‰ -->
                        <ellipse cx="0" cy="0" rx="60" ry="18" fill="none" stroke="#FF5722" stroke-width="2.5" opacity="0">
                            <animate attributeName="rx" values="60; 85" dur="0.6s" repeatCount="indefinite"/>
                            <animate attributeName="ry" values="18; 28" dur="0.6s" repeatCount="indefinite"/>
                            <animate attributeName="opacity" values="0.8; 0" dur="0.6s" repeatCount="indefinite"/>
                        </ellipse>
                        <ellipse cx="0" cy="0" rx="60" ry="18" fill="none" stroke="#FF7043" stroke-width="2" opacity="0">
                            <animate attributeName="rx" values="60; 85" dur="0.6s" begin="0.2s" repeatCount="indefinite"/>
                            <animate attributeName="ry" values="18; 28" dur="0.6s" begin="0.2s" repeatCount="indefinite"/>
                            <animate attributeName="opacity" values="0.6; 0" dur="0.6s" begin="0.2s" repeatCount="indefinite"/>
                        </ellipse>
                        <ellipse cx="0" cy="0" rx="60" ry="18" fill="none" stroke="#FF8A65" stroke-width="1.5" opacity="0">
                            <animate attributeName="rx" values="60; 85" dur="0.6s" begin="0.4s" repeatCount="indefinite"/>
                            <animate attributeName="ry" values="18; 28" dur="0.6s" begin="0.4s" repeatCount="indefinite"/>
                            <animate attributeName="opacity" values="0.4; 0" dur="0.6s" begin="0.4s" repeatCount="indefinite"/>
                        </ellipse>
                    </g>
                    
                    <!-- æ‰‹è§¦æ‘¸ -->
                    <g transform="translate(260, 50)">
                        <text x="0" y="0" font-size="35">ğŸ–ï¸</text>
                        <text x="0" y="30" font-size="11" fill="#D32F2F" font-weight="bold">æ‰‹æ„Ÿè§‰</text>
                        <text x="0" y="43" font-size="11" fill="#D32F2F" font-weight="bold">éº»éº»çš„</text>
                        
                        <!-- æŒ¯åŠ¨æŒ‡ç¤º -->
                        <path d="M-10,10 Q-5,5 0,10 Q5,15 10,10" stroke="#FF5722" stroke-width="2" fill="none">
                            <animate attributeName="opacity" values="1; 0.3; 1" dur="0.3s" repeatCount="indefinite"/>
                        </path>
                    </g>
                    
                    <!-- è¯´æ˜æ–‡å­— -->
                    <text x="160" y="120" text-anchor="middle" font-size="11" fill="#5E35B1" font-weight="bold">ğŸ’¡ é¼“é¢æŒ¯åŠ¨ â†’ äº§ç”Ÿå£°æ³¢ â†’ æ‰‹æ„Ÿå—åˆ°æŒ¯åŠ¨</text>
                </svg>
            </div>
        </div>

        <!-- å®éªŒ3ï¼šç«–ç¬›ä¸å£°å¸¦ -->
        <div class="knowledge-box">
            <h3>ğŸ§ª å®éªŒ3ï¼šçœ‹ä¸è§çš„æŒ¯åŠ¨</h3>
            <div class="k-point">ğŸ’¨ <strong>å¹ç«–ç¬›</strong>ï¼šæ˜¯ç«–ç¬›é‡Œçš„<span class="highlight">ç©ºæ°”æŸ±</span>åœ¨æŒ¯åŠ¨ã€‚</div>
            <div class="k-point">ğŸ—£ï¸ <strong>è¯´è¯</strong>ï¼šä¾èµ–å–‰å’™é‡Œçš„<span class="highlight">å£°å¸¦</span>æŒ¯åŠ¨ã€‚å£°å¸¦è¶Šç´§ï¼Œå£°éŸ³è¶Šé«˜ã€‚</div>

            <div class="experiment-stage">
                <svg width="100%" height="100" viewBox="0 0 300 100">
                    <!-- ç«–ç¬› -->
                    <rect x="20" y="30" width="100" height="20" fill="#B2DFDB" stroke="#00796B"/>
                    <circle cx="30" cy="40" r="3" fill="black"/>
                    <circle cx="50" cy="40" r="3" fill="black"/>
                    <circle cx="70" cy="40" r="3" fill="black"/>
                    
                    <!-- ç©ºæ°”ç²’å­æŒ¯åŠ¨ -->
                    <circle cx="110" cy="40" r="2" fill="#009688"><animate attributeName="cx" values="110;115;110" dur="0.1s" repeatCount="indefinite"/></circle>
                    <circle cx="100" cy="35" r="2" fill="#009688"><animate attributeName="cx" values="100;105;100" dur="0.1s" repeatCount="indefinite"/></circle>
                    <text x="70" y="80" font-size="10" fill="#555">ç«–ç¬›ï¼šç©ºæ°”æŒ¯åŠ¨</text>

                    <!-- å£°å¸¦ -->
                    <g transform="translate(180, 20)">
                         <path d="M10,10 Q30,30 10,50" fill="none" stroke="#F48FB1" stroke-width="5"/>
                         <path d="M50,10 Q30,30 50,50" fill="none" stroke="#F48FB1" stroke-width="5"/>
                         <!-- æŒ¯åŠ¨ -->
                         <path d="M20,20 L40,20" stroke="#E91E63" stroke-width="2">
                             <animate attributeName="d" values="M25,30 L35,30; M20,30 L40,30; M25,30 L35,30" dur="0.1s" repeatCount="indefinite"/>
                         </path>
                         <text x="60" y="35" font-size="12" fill="#333">å£°å¸¦å˜ç´§</text>
                         <text x="60" y="50" font-size="12" fill="#333">å¿«é€ŸæŒ¯åŠ¨</text>
                    </g>
                </svg>
            </div>
        </div>

        <button class="btn" onclick="startQuiz()">æŒ‘æˆ˜35é¢˜é—¯å…³å¡”ï¼ğŸš€</button>
    </div>

    <!-- 2. é—¯å…³åŒº -->
    <div id="section-quiz" class="container section">
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div style="text-align:right; font-size:0.9em; color:#888;">é¢˜ç›®ï¼š<span id="q-index">1</span> / 35</div>

        <div id="question-area"></div>
        
        <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â–¶</button>
    </div>

    <!-- 3. ç»“ç®—åŒº -->
    <div id="section-result" class="container section">
        <h1>ğŸ† é—¯å…³æˆç»©</h1>
        <div class="score-display"><span id="final-score">0</span>åˆ†</div>
        <p id="reward-text"></p>
        
        <div id="wrong-list" style="display:none;">
            <h3 style="color:#E57373;">âŒ é”™é¢˜è§£æ</h3>
            <!-- é”™é¢˜æ’å…¥ -->
        </div>
        <button class="btn" onclick="location.reload()">ğŸ”„ é‡æ–°æŒ‘æˆ˜</button>
    </div>

    <script>
        // --- å³æ—¶åé¦ˆç³»ç»Ÿ ---
        const InstantFeedback={audioCtx:null,encouragements:['å¤ªæ£’äº†ï¼ç»§ç»­åŠ æ²¹ï¼ğŸŒŸ','ä½ çœŸèªæ˜ï¼ğŸ‘','å®Œå…¨æ­£ç¡®ï¼çœŸå‰å®³ï¼ğŸ¯','ç­”å¯¹äº†ï¼ä½ æ˜¯æœ€æ£’çš„ï¼â­','å¤ªä¼˜ç§€äº†ï¼ç»§ç»­ä¿æŒï¼ğŸ†','çœŸæ˜¯ä¸ªå°å¤©æ‰ï¼ğŸ’¡','å›ç­”å¾—éå¸¸å¥½ï¼ğŸ‘','ä½ æŒæ¡å¾—å¾ˆå¥½ï¼ğŸ“š'],hints:['å†æƒ³æƒ³å“¦ï¼ä½ å¯ä»¥çš„ï¼ğŸ’ª','åˆ«ç°å¿ƒï¼Œå†è¯•ä¸€æ¬¡ï¼ğŸŒˆ','åŠ æ²¹ï¼ä»”ç»†çœ‹çœ‹é¢˜ç›®ï¼ğŸ‘€','æ²¡å…³ç³»ï¼Œç»§ç»­åŠªåŠ›ï¼ğŸ’«','å†çœ‹çœ‹çŸ¥è¯†ç‚¹å§ï¼ğŸ“–','ä¸è¦æ”¾å¼ƒï¼Œä½ èƒ½è¡Œï¼ğŸš€','æ€è€ƒä¸€ä¸‹ï¼Œä½ ä¸€å®šèƒ½æƒ³åˆ°ï¼ğŸ¤”','åŠ æ²¹ï¼ç›¸ä¿¡è‡ªå·±ï¼âœ¨'],init(){if(!this.audioCtx)this.audioCtx=new(window.AudioContext||window.webkitAudioContext)()},playCorrectSound(){this.init();if(this.audioCtx.state==='suspended')this.audioCtx.resume();const notes=[523.25,659.25,783.99];notes.forEach((freq,i)=>{const osc=this.audioCtx.createOscillator();const gain=this.audioCtx.createGain();osc.connect(gain);gain.connect(this.audioCtx.destination);const now=this.audioCtx.currentTime;const start=now+i*0.1;osc.frequency.value=freq;osc.type='sine';gain.gain.setValueAtTime(0.15,start);gain.gain.exponentialRampToValueAtTime(0.01,start+0.3);osc.start(start);osc.stop(start+0.3)})},playWrongSound(){this.init();if(this.audioCtx.state==='suspended')this.audioCtx.resume();const osc=this.audioCtx.createOscillator();const gain=this.audioCtx.createGain();osc.connect(gain);gain.connect(this.audioCtx.destination);const now=this.audioCtx.currentTime;osc.frequency.setValueAtTime(300,now);osc.frequency.linearRampToValueAtTime(250,now+0.2);osc.type='triangle';gain.gain.setValueAtTime(0.1,now);gain.gain.linearRampToValueAtTime(0,now+0.2);osc.start(now);osc.stop(now+0.2)},showConfetti(){const colors=['#FF6B6B','#4ECDC4','#45B7D1','#FFA07A','#98D8C8','#F7DC6F','#BB8FCE'];for(let i=0;i<30;i++){setTimeout(()=>{const c=document.createElement('div');c.className='confetti';c.style.cssText=`width: ${Math.random()*10+5}px; height: ${Math.random()*10+5}px; background: ${colors[Math.floor(Math.random()*colors.length)]}; left: ${Math.random()*100}%; top: -20px; border-radius: ${Math.random()>0.5?'50%':'0'}; animation: confetti-fall ${Math.random()*2+2}s linear forwards; transform: rotate(${Math.random()*360}deg);`;document.body.appendChild(c);setTimeout(()=>c.remove(),4000)},i*30)}},showToast(message,type='success'){const toast=document.createElement('div');toast.className=`feedback-toast feedback-${type}`;toast.innerHTML=`<div class="toast-icon">${type==='success'?'âœ“':'âœ—'}</div><div class="toast-message">${message}</div>`;document.body.appendChild(toast);setTimeout(()=>toast.classList.add('show'),10);setTimeout(()=>{toast.classList.remove('show');setTimeout(()=>toast.remove(),300)},2500)},onCorrect(element){this.playCorrectSound();this.showConfetti();const msg=this.encouragements[Math.floor(Math.random()*this.encouragements.length)];this.showToast(msg,'success');if(element){element.classList.add('correct-feedback');setTimeout(()=>element.classList.remove('correct-feedback'),600)}},onWrong(element,hint=''){this.playWrongSound();const msg=this.hints[Math.floor(Math.random()*this.hints.length)]+(hint?`<br><small style="font-size:0.85em;">ğŸ’¡ ${hint}</small>`:'');this.showToast(msg,'error');if(element){element.classList.add('wrong-feedback');setTimeout(()=>element.classList.remove('wrong-feedback'),500)}}};InstantFeedback.init();

        // --- é¢˜åº“ (35é¢˜ï¼šé€‰æ‹©ã€è¿çº¿ã€å¡«ç©ºã€å®éªŒ) ---
        const quizData = [
            // åŸºç¡€æ¦‚å¿µ (é€‰æ‹©)
            { type: 'mcq', q: 'å£°éŸ³æ˜¯ç”±ç‰©ä½“çš„____äº§ç”Ÿçš„ã€‚', opts: ['å¼¯æ›²', 'æŒ¯åŠ¨', 'æ–­è£‚'], a: 1, exp: 'å£°éŸ³æ˜¯ç”±ç‰©ä½“æŒ¯åŠ¨äº§ç”Ÿçš„ã€‚' },
            { type: 'mcq', q: 'å¦‚æœç‰©ä½“åœæ­¢æŒ¯åŠ¨ï¼Œå£°éŸ³ä¼šï¼Ÿ', opts: ['ç»§ç»­å‘å£°', 'ç«‹å³åœæ­¢', 'å˜å°'], a: 1, exp: 'æŒ¯åŠ¨åœæ­¢ï¼Œå‘å£°ä¹Ÿå°±åœæ­¢äº†ã€‚' },
            { type: 'mcq', q: 'ç”¨åŠ›æ‹‰ä¼¸çš®ç­‹ï¼ˆä¿æŒé™æ­¢ï¼‰ï¼Œçš®ç­‹ä¼šå‘å£°å—ï¼Ÿ', opts: ['ä¼š', 'ä¸ä¼š', 'å£°éŸ³å¾ˆå°'], a: 1, exp: 'çš®ç­‹æ²¡æœ‰æŒ¯åŠ¨ï¼Œæ‰€ä»¥ä¸ä¼šå‘å£°ã€‚' },
            { type: 'mcq', q: 'ç”¨åŠ›æ‰æ“çš®ç­‹ï¼Œçš®ç­‹ä¼šå‘å‡ºä¹éŸ³å—ï¼Ÿ', opts: ['ä¼š', 'ä¸ä¼š', 'çœ‹æƒ…å†µ'], a: 1, exp: 'æ‰æ“ä¸èƒ½è®©çš®ç­‹è¿›è¡Œè§„å¾‹çš„æŒ¯åŠ¨å‘å£°ã€‚' },
            { type: 'mcq', q: 'å¼¹æ‹¨çš®ç­‹æ—¶ï¼Œçš®ç­‹çš„è¿åŠ¨æ–¹å¼æ˜¯ï¼Ÿ', opts: ['å¾€è¿”è¿åŠ¨(æŒ¯åŠ¨)', 'åœ†å‘¨è¿åŠ¨', 'ç›´çº¿è¿åŠ¨'], a: 0, exp: 'æŒ¯åŠ¨æ˜¯ä¸€ç§å¾€è¿”è¿åŠ¨ã€‚' },
            
            // ä¹å™¨ä¸å‘å£° (è¿çº¿ - ç®€åŒ–ä¸ºé€‰æ‹©å½¢å¼ä»¥é€‚é…æ‰‹æœº)
            { type: 'matching', q: 'è¯·å°†ä¸‹åˆ—ä¹å™¨ä¸å…¶æŒ¯åŠ¨çš„éƒ¨ä½è¿çº¿ï¼š', 
              pairs: [ {l:'ç«–ç¬›', r:'ç©ºæ°”æŸ±'}, {l:'é¼“', r:'é¼“é¢'}, {l:'å‰ä»–', r:'ç´å¼¦'} ],
              exp: 'ç«–ç¬›å¹æ°”éœ‡åŠ¨ç©ºæ°”ï¼›é¼“æ•²å‡»éœ‡åŠ¨é¼“é¢ï¼›å‰ä»–å¼¹æ‹¨éœ‡åŠ¨ç´å¼¦ã€‚' 
            },

            // å®éªŒåˆ†æ (åˆ¤æ–­/é€‰æ‹©)
            { type: 'mcq', q: 'ç”¨æ‰‹è§¦æ‘¸æ­£åœ¨å‘å£°çš„éŸ³å‰ï¼Œæ„Ÿè§‰æ‰‹éº»éº»çš„ï¼Œè¿™è¯´æ˜ï¼Ÿ', opts: ['éŸ³å‰åœ¨æ¼ç”µ', 'éŸ³å‰åœ¨æŒ¯åŠ¨', 'éŸ³å‰å¾ˆçƒ­'], a: 1, exp: 'éº»éº»çš„æ„Ÿè§‰æ˜¯éŸ³å‰é«˜é¢‘æŒ¯åŠ¨å¼•èµ·çš„ã€‚' },
            { type: 'mcq', q: 'å‡»é¼“æ—¶ï¼Œé¼“é¢ä¸Šæ”¾å‡ ç²’è±†å­ï¼Œè±†å­ä¼šè·³èµ·æ¥ï¼Œè¯´æ˜ï¼Ÿ', opts: ['è±†å­æ€•å£°éŸ³', 'é¼“é¢åœ¨æŒ¯åŠ¨', 'é£å¹çš„'], a: 1, exp: 'é¼“é¢çš„æŒ¯åŠ¨æŠŠè±†å­å¼¹èµ·æ¥äº†ã€‚' },
            { type: 'mcq', q: 'å¹ç«–ç¬›æ—¶ï¼Œç”¨æ‰‹æŒ‡æŒ‰ä½ä¸åŒçš„å­”ï¼Œæ˜¯ä¸ºäº†æ”¹å˜ï¼Ÿ', opts: ['ç©ºæ°”æŸ±çš„é•¿çŸ­', 'ç«–ç¬›çš„é¢œè‰²', 'å¹æ°”çš„åŠ›åº¦'], a: 0, exp: 'æ”¹å˜ç©ºæ°”æŸ±é•¿çŸ­å¯ä»¥æ”¹å˜éŸ³é«˜ã€‚' },
            { type: 'fill', q: 'æˆ‘ä»¬è¯´è¯ä¸»è¦ä¾èµ–å–‰å’™é‡Œçš„____æŒ¯åŠ¨ã€‚', a: ['å£°å¸¦'], exp: 'å£°å¸¦æŒ¯åŠ¨äº§ç”Ÿäººå£°ã€‚' },
            
            // å£°å¸¦ä¸“é¢˜
            { type: 'mcq', q: 'å‘å£°æ—¶ï¼Œæˆ‘ä»¬çš„å£°å¸¦æ˜¯æ€æ ·çš„ï¼Ÿ', opts: ['æ”¾æ¾çš„', 'æ‹‰ç´§çš„', 'æ–­å¼€çš„'], a: 1, exp: 'å‘å£°æ—¶å£°å¸¦å˜ç´§å¹¶å¿«é€ŸæŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'å£°å¸¦è¶Šç´§ï¼Œå‘å‡ºçš„å£°éŸ³è¶Š____ï¼Ÿ', opts: ['é«˜', 'ä½', 'å¼º'], a: 0, exp: 'å£°å¸¦è¶Šç´§ï¼ŒæŒ¯åŠ¨è¶Šå¿«ï¼Œå£°éŸ³è¶Šé«˜ã€‚' },
            { type: 'mcq', q: 'æŠŠæ‰‹æ”¾åœ¨å–‰ç»“å¤„è¯´è¯ï¼Œæ‰‹ä¼šæ„Ÿè§‰åˆ°æŒ¯åŠ¨å—ï¼Ÿ', opts: ['ä¼š', 'ä¸ä¼š'], a: 0, exp: 'å¯ä»¥æ„Ÿè§‰åˆ°å£°å¸¦çš„æŒ¯åŠ¨ã€‚' },

            // ç»¼åˆæŒ‘æˆ˜
            { type: 'mcq', q: 'æ°´é¾™å¤´çš„æ»´æ°´å£°æ˜¯____æŒ¯åŠ¨äº§ç”Ÿçš„ã€‚', opts: ['æ°´', 'æ°´ç®¡', 'ç©ºæ°”'], a: 0, exp: 'æ°´æ»´æ’å‡»å¼•èµ·æ°´çš„æŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'èšŠå­å‘å‡ºçš„â€œå—¡å—¡â€å£°æ˜¯____æŒ¯åŠ¨äº§ç”Ÿçš„ã€‚', opts: ['å˜´å·´', 'ç¿…è†€', 'è…¿'], a: 1, exp: 'èšŠå­ç¿…è†€å¿«é€ŸæŒ¯åŠ¨äº§ç”Ÿå£°éŸ³ã€‚' },
            { type: 'mcq', q: 'åœ¨çœŸç©ºä¸­ï¼ˆæ²¡æœ‰ç©ºæ°”ï¼‰ï¼Œç‰©ä½“æŒ¯åŠ¨èƒ½å¬åˆ°å£°éŸ³å—ï¼Ÿ', opts: ['èƒ½', 'ä¸èƒ½'], a: 1, exp: 'è™½ç„¶æœ‰æŒ¯åŠ¨ï¼Œä½†æ²¡æœ‰ç‰©è´¨ä¼ æ’­ï¼Œæ‰€ä»¥å¬ä¸åˆ°ï¼ˆè¿™æ˜¯ç¬¬ä¸€è¯¾çŸ¥è¯†ç‚¹çš„å»¶ä¼¸ï¼‰ã€‚' },
            { type: 'fill', q: 'ä¸€ä¸ªç‰©ä½“åœ¨åŠ›çš„ä½œç”¨ä¸‹ï¼Œä¸æ–­é‡å¤åœ°åš____è¿åŠ¨ï¼Œç§°ä¸ºæŒ¯åŠ¨ã€‚', a: ['å¾€è¿”'], exp: 'æŒ¯åŠ¨çš„å®šä¹‰ï¼šå¾€è¿”è¿åŠ¨ã€‚' },
            { type: 'mcq', q: 'ç”¨åŠ›æ•²é”£ï¼Œåœæ­¢æ•²å‡»åé”£å£°è¿˜åœ¨æŒç»­ï¼Œæ˜¯å› ä¸ºï¼Ÿ', opts: ['é”£é¢è¿˜åœ¨æŒ¯åŠ¨', 'å£°éŸ³æœ‰å›å£°', 'å¹»è§‰'], a: 0, exp: 'æ•²å‡»åœæ­¢ä½†æŒ¯åŠ¨ä¸ä¼šç«‹åˆ»æ¶ˆå¤±ï¼ˆä½™éŸ³ç»•æ¢ï¼‰ã€‚' },
            { type: 'mcq', q: 'æ€æ ·è®©æ­£åœ¨å‘å£°çš„é”£ç«‹åˆ»åœæ­¢å£°éŸ³ï¼Ÿ', opts: ['ä¸å†æ•²', 'ç”¨æ‰‹æŒ‰ä½é”£é¢', 'å¤§å£°å–Šåœ'], a: 1, exp: 'æŒ‰ä½é”£é¢å¼ºåˆ¶åœæ­¢æŒ¯åŠ¨ã€‚' },

            // æ›´å¤šåŸºç¡€å·©å›º (å‡‘é½35é¢˜)
            { type: 'mcq', q: 'çš®ç­‹ç»·å¾—è¶Šç´§ï¼Œå¼¹æ‹¨æ—¶å£°éŸ³ï¼Ÿ', opts: ['è¶Šé«˜', 'è¶Šä½', 'è¶Šå¼±'], a: 0, exp: 'è¶Šç´§æŒ¯åŠ¨è¶Šå¿«ï¼Œå£°éŸ³è¶Šé«˜ã€‚' },
            { type: 'mcq', q: 'æˆ‘ä»¬èƒ½å¬åˆ°é£å£°ï¼Œæ˜¯å› ä¸º____åœ¨æŒ¯åŠ¨ã€‚', opts: ['æ ‘å¶', 'ç©ºæ°”', 'è€³æœµ'], a: 1, exp: 'é£æ˜¯ç©ºæ°”çš„æµåŠ¨å’ŒæŒ¯åŠ¨ã€‚' },
            { type: 'matching', q: 'å°†åŠ¨ä½œä¸ç»“æœè¿çº¿ï¼š', 
              pairs: [{l:'æŒ‰å‹çš®ç­‹', r:'ä¸å‘å£°'}, {l:'å¼¹æ‹¨çš®ç­‹', r:'å‘å£°'}, {l:'æ‹‰ä¼¸çš®ç­‹', r:'ä¸å‘å£°'}], 
              exp: 'åªæœ‰å¼¹æ‹¨èƒ½å¼•èµ·æŒç»­æŒ¯åŠ¨ã€‚' 
            },
            { type: 'mcq', q: 'ä¸‹åˆ—å“ªä¸ªåŠ¨ä½œèƒ½è®©çš®ç­‹å‘å‡ºå£°éŸ³ï¼Ÿ', opts: ['æ¨ªå‘æ‹‰åŠ¨', 'ç”¨åŠ›æ‹‰é•¿', 'è½»è½»æ‰æ“'], a: 0, exp: 'æ¨ªå‘æ‹‰åŠ¨ï¼ˆå¼¹æ‹¨ï¼‰å¼•èµ·æŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'å£°å¸¦å°±åƒä¸€æ ¹____ï¼Œå˜ç´§æ—¶èƒ½å‘å£°ã€‚', opts: ['æœ¨æ£', 'çš®ç­‹', 'é“ä¸'], a: 1, exp: 'å£°å¸¦çš„æ€§è´¨åƒçš®ç­‹ã€‚' },
            { type: 'fill', q: 'å£°éŸ³æ˜¯ç”±ç‰©ä½“____äº§ç”Ÿçš„ã€‚', a: ['æŒ¯åŠ¨'], exp: 'æ ¸å¿ƒæ¦‚å¿µï¼šæŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'ä¸ç®¡æ˜¯ä»€ä¹ˆç‰©ä½“ï¼Œåªè¦å‘å‡ºå£°éŸ³ï¼Œå°±ä¸€å®šåœ¨ï¼Ÿ', opts: ['è¿åŠ¨', 'æŒ¯åŠ¨', 'å‘çƒ­'], a: 1, exp: 'å‘å£°å¿…æŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å…³äºå£°éŸ³çš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ', opts: ['å£°éŸ³æ˜¯æŒ¯åŠ¨äº§ç”Ÿçš„', 'ç‰©ä½“ä¸æŒ¯åŠ¨ä¹Ÿèƒ½å‘å£°', 'æŒ¯åŠ¨åœæ­¢å£°éŸ³åœæ­¢'], a: 1, exp: 'ç‰©ä½“ä¸æŒ¯åŠ¨æ˜¯ä¸å¯èƒ½å‘å£°çš„ã€‚' },
            { type: 'mcq', q: 'å¹æ°”çƒæ—¶å‘å‡ºçš„å£°éŸ³æ˜¯____æŒ¯åŠ¨äº§ç”Ÿçš„ã€‚', opts: ['æ°”çƒçš®', 'ç©ºæ°”', 'å˜´å·´'], a: 0, exp: 'æ°”æµå†²å‡ºä½¿æ°”çƒçš®æŒ¯åŠ¨ï¼ˆä¹ŸåŒ…å«ç©ºæ°”æŒ¯åŠ¨ï¼‰ã€‚' },
            { type: 'mcq', q: 'æ•²å‡»è£…æ°´çš„ç»ç’ƒæ¯ï¼Œä¸»è¦æŒ¯åŠ¨çš„æ˜¯ï¼Ÿ', opts: ['æ¯å­å’Œæ°´', 'ç©ºæ°”', 'æ¡Œå­'], a: 0, exp: 'æ¯å­å’Œæ°´å…±åŒæŒ¯åŠ¨ã€‚' },
            { type: 'fill', q: 'å¹å£å“¨æ˜¯____åœ¨æŒ¯åŠ¨ã€‚', a: ['ç©ºæ°”', 'æ°”æµ'], exp: 'å£å“¨æ˜¯æ°”æµæŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'ç”¨æ‰‹æ‹æ¡Œå­å¬åˆ°å£°éŸ³ï¼Œæ˜¯å› ä¸ºï¼Ÿ', opts: ['æ‰‹æŒ¯åŠ¨', 'æ¡Œå­æŒ¯åŠ¨', 'æ‰‹å’Œæ¡Œå­éƒ½æŒ¯åŠ¨'], a: 2, exp: 'ç›¸äº’ä½œç”¨ï¼Œéƒ½æœ‰æŒ¯åŠ¨ã€‚' },
            { type: 'mcq', q: 'ä¸ºä»€ä¹ˆæ‹‰ä¼¸çš„çš®ç­‹ä¸å‘å£°ï¼Ÿ', opts: ['å› ä¸ºæ‹‰å¾—ä¸å¤Ÿé•¿', 'å› ä¸ºæ²¡æœ‰æŒ¯åŠ¨', 'å› ä¸ºçš®ç­‹å¤ªç»†'], a: 1, exp: 'æ²¡æœ‰åšå¾€è¿”è¿åŠ¨ï¼ˆæŒ¯åŠ¨ï¼‰ã€‚' },
            { type: 'mcq', q: 'è¦æƒ³è®©æ©¡çš®ç­‹å‘å‡ºçš„å£°éŸ³æ›´é«˜ï¼Œåº”è¯¥ï¼Ÿ', opts: ['æ‹‰å¾—æ¾ä¸€ç‚¹', 'æ‹‰å¾—ç´§ä¸€ç‚¹', 'ç”¨åŠ›å¼¹'], a: 1, exp: 'æ‹‰ç´§é¢‘ç‡é«˜ï¼ŒéŸ³é«˜é«˜ã€‚' },
            { type: 'mcq', q: 'äººçš„å£°å¸¦ä½äºï¼Ÿ', opts: ['å£è…”', 'å–‰å’™', 'è‚ºéƒ¨'], a: 1, exp: 'å£°å¸¦åœ¨å–‰å’™é‡Œã€‚' }
        ];

        // çŠ¶æ€å˜é‡
        let currentQIndex = 0;
        let userScoreRaw = 0;
        let userMistakes = [];
        let selectedOption = null;
        let matchState = { left: null, right: null, matchedCount: 0 };
        
        // éŸ³é¢‘ä¸Šä¸‹æ–‡
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;
            if (type === 'correct') {
                osc.frequency.setValueAtTime(500, now); osc.frequency.exponentialRampToValueAtTime(1000, now + 0.1);
                gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            } else if (type === 'wrong') {
                osc.type = 'square'; osc.frequency.setValueAtTime(150, now); osc.frequency.linearRampToValueAtTime(100, now + 0.2);
                gain.gain.setValueAtTime(0.05, now); gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            } else if (type === 'click') {
                osc.frequency.setValueAtTime(400, now); gain.gain.setValueAtTime(0.02, now); gain.gain.linearRampToValueAtTime(0, now + 0.05);
                osc.start(now); osc.stop(now + 0.05);
            }
        }

        function startQuiz() {
            document.getElementById('section-review').classList.remove('active');
            document.getElementById('section-quiz').classList.add('active');
            currentQIndex = 0; userScoreRaw = 0; userMistakes = [];
            renderQuestion();
        }

        function renderQuestion() {
            const qData = quizData[currentQIndex];
            const area = document.getElementById('question-area');
            const nextBtn = document.getElementById('nextBtn');
            
            // æ›´æ–°è¿›åº¦
            document.getElementById('q-index').innerText = currentQIndex + 1;
            document.getElementById('progressBar').style.width = ((currentQIndex) / quizData.length * 100) + "%";
            
            area.innerHTML = '';
            nextBtn.disabled = true; nextBtn.style.opacity = 0.5;
            selectedOption = null;

            const card = document.createElement('div');
            card.className = 'question-card';
            
            let tagText = qData.type === 'mcq' ? 'é€‰æ‹©é¢˜' : (qData.type === 'fill' ? 'å¡«ç©ºé¢˜' : 'è¿çº¿é¢˜');
            card.innerHTML = `<div class="q-content"><span class="q-tag">${tagText}</span>${qData.q}</div>`;

            // æ¸²æŸ“é¢˜ç›®
            if (qData.type === 'mcq') {
                qData.opts.forEach((opt, idx) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-item'; btn.innerText = opt;
                    btn.onclick = () => selectMCQ(btn, idx);
                    card.appendChild(btn);
                });
            } else if (qData.type === 'fill') {
                const input = document.createElement('input');
                input.className = 'fill-input'; input.type = 'text'; input.placeholder = 'è¾“å…¥ç­”æ¡ˆ';
                input.oninput = (e) => {
                    selectedOption = e.target.value.trim();
                    nextBtn.disabled = !selectedOption;
                    nextBtn.style.opacity = selectedOption ? 1 : 0.5;
                };
                input.onblur = () => {
                    if (selectedOption) {
                        const isCorrect = qData.a.some(ans => selectedOption.includes(ans));
                        setTimeout(() => {
                            if (isCorrect) InstantFeedback.onCorrect(input);
                            else InstantFeedback.onWrong(input, qData.exp);
                        }, 200);
                    }
                };
                card.appendChild(input);
            } else if (qData.type === 'matching') {
                renderMatching(card, qData);
            }

            area.appendChild(card);
        }

        function selectMCQ(el, idx) {
            playSound('click');
            document.querySelectorAll('.option-item').forEach(i => i.classList.remove('selected','correct-feedback','wrong-feedback'));
            el.classList.add('selected');
            selectedOption = idx;
            
            // ç«‹å³æ£€æŸ¥ç­”æ¡ˆ
            const qData = quizData[currentQIndex];
            const isCorrect = (idx === qData.a);
            
            setTimeout(() => {
                if (isCorrect) {
                    InstantFeedback.onCorrect(el);
                } else {
                    InstantFeedback.onWrong(el, qData.exp);
                }
            }, 200);
            
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('nextBtn').style.opacity = 1;
        }

        function renderMatching(card, qData) {
            const container = document.createElement('div');
            container.className = 'match-container';
            const leftCol = document.createElement('div'); leftCol.className = 'match-col';
            const rightCol = document.createElement('div'); rightCol.className = 'match-col';
            
            // æ‰“ä¹±å³ä¾§
            let rItems = [...qData.pairs].sort(()=>Math.random()-0.5);
            matchState = { left: null, right: null, matchedCount: 0, userPairs: [] };

            qData.pairs.forEach(p => {
                const btn = document.createElement('div');
                btn.className = 'match-btn'; btn.innerText = p.l; btn.dataset.val = p.l; btn.dataset.side = 'left';
                btn.onclick = (e) => handleMatchClick(e.target, qData.pairs.length);
                leftCol.appendChild(btn);
            });
            rItems.forEach(p => {
                const btn = document.createElement('div');
                btn.className = 'match-btn'; btn.innerText = p.r; btn.dataset.val = p.r; btn.dataset.side = 'right';
                btn.onclick = (e) => handleMatchClick(e.target, qData.pairs.length);
                rightCol.appendChild(btn);
            });

            container.appendChild(leftCol); container.appendChild(rightCol);
            card.appendChild(container);
        }

        function handleMatchClick(el, totalPairs) {
            playSound('click');
            const side = el.dataset.side;
            // æ¸…é™¤åŒä¾§é«˜äº®
            el.parentElement.querySelectorAll('.match-btn').forEach(b => b.classList.remove('selected'));
            el.classList.add('selected');
            
            if (side === 'left') matchState.left = el;
            else matchState.right = el;

            if (matchState.left && matchState.right) {
                // è®°å½•é…å¯¹
                matchState.userPairs.push({l: matchState.left.dataset.val, r: matchState.right.dataset.val});
                
                // è§†è§‰é”å®š
                matchState.left.classList.remove('selected'); matchState.left.classList.add('matched');
                matchState.right.classList.remove('selected'); matchState.right.classList.add('matched');
                
                matchState.left = null; matchState.right = null;
                matchState.matchedCount++;

                if (matchState.matchedCount === totalPairs) {
                    document.getElementById('nextBtn').disabled = false;
                    document.getElementById('nextBtn').style.opacity = 1;
                }
            }
        }

        function nextQuestion() {
            const qData = quizData[currentQIndex];
            let isCorrect = false;

            if (qData.type === 'mcq') {
                if (selectedOption === qData.a) isCorrect = true;
            } else if (qData.type === 'fill') {
                if (qData.a.some(ans => selectedOption.includes(ans))) isCorrect = true;
            } else if (qData.type === 'matching') {
                // æ£€æŸ¥é…å¯¹æ˜¯å¦å…¨éƒ¨æ­£ç¡®
                let correctCount = 0;
                matchState.userPairs.forEach(up => {
                    if (qData.pairs.some(p => p.l === up.l && p.r === up.r)) correctCount++;
                });
                if (correctCount === qData.pairs.length) isCorrect = true;
            }

            if (isCorrect) {
                userScoreRaw++;
                playSound('correct');
            } else {
                playSound('wrong');
                let myAns = 'å›ç­”é”™è¯¯';
                if(qData.type === 'mcq') myAns = qData.opts[selectedOption];
                if(qData.type === 'fill') myAns = selectedOption;
                
                userMistakes.push({
                    q: qData.q,
                    my: myAns,
                    exp: qData.exp
                });
            }

            currentQIndex++;
            if (currentQIndex < quizData.length) renderQuestion();
            else showResults();
        }

        function showResults() {
            document.getElementById('section-quiz').classList.remove('active');
            document.getElementById('section-result').classList.add('active');
            
            // 35é¢˜ï¼Œæ¯é¢˜çº¦2.85åˆ†ï¼Œå››èˆäº”å…¥
            let finalScore = Math.round((userScoreRaw / quizData.length) * 100);
            
            let temp = 0;
            const scoreEl = document.getElementById('final-score');
            const timer = setInterval(() => {
                if(temp >= finalScore) { clearInterval(timer); scoreEl.innerText = finalScore; }
                else { temp++; scoreEl.innerText = temp; }
            }, 20);

            const reward = document.getElementById('reward-text');
            if(finalScore === 100) reward.innerText = "ğŸ‰ å®Œç¾ï¼ä½ æ˜¯å£°éŸ³å¤§å¸ˆï¼";
            else if(finalScore >= 80) reward.innerText = "ğŸŒŸ ä¼˜ç§€ï¼æŒæ¡å¾—å¾ˆæ£’ï¼";
            else reward.innerText = "ğŸ’ª åŠ æ²¹ï¼å¼„æ‡‚é”™é¢˜å†æ¥ä¸€æ¬¡ï¼";

            if (userMistakes.length > 0) {
                const list = document.getElementById('wrong-list');
                list.style.display = 'block';
                let html = '';
                userMistakes.forEach((m, i) => {
                    html += `<div class="wrong-item"><strong>${i+1}. ${m.q}</strong><br><span style="font-size:0.9em; color:#D32F2F">ä½ çš„å›ç­”ï¼š${m.my}</span><br><span style="font-size:0.9em; color:#388E3C">ğŸ’¡ è§£æï¼š${m.exp}</span></div>`;
                });
                list.innerHTML += html;
            }
        }
    </script>
</body>
</html>