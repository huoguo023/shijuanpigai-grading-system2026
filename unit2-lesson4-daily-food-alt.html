<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬å››è¯¾ï¼šä¸€å¤©çš„é£Ÿç‰© - ç§‘å­¦å¤§é—¯å…³</title>
    <style>
        :root {
            --bg-color: #FFFDE7; /* å¥¶æ²¹è‰²èƒŒæ™¯ï¼Œä»£è¡¨é£Ÿç‰© */
            --card-bg: #FFFFFF;
            --primary: #FF9800; /* æ©™è‰² */
            --secondary: #8BC34A; /* è”¬èœç»¿ */
            --accent: #F44336; /* è‚‰ç±»çº¢ */
            --text: #3E2723;
            --font-main: "Microsoft YaHei", -apple-system, sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            background-image: radial-gradient(#FFCC80 15%, transparent 16%);
            background-size: 25px 25px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            border: 4px solid #FFCC80;
            overflow: hidden;
        }

        h1 { color: #E65100; margin-top: 0; font-size: 1.6em; margin-bottom: 5px; }
        .subtitle { color: #F57C00; font-size: 1em; margin-bottom: 15px; font-weight: bold; }

        /* åŒºåŸŸåˆ‡æ¢ */
        .section { display: none; animation: fadeIn 0.4s ease-out; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* çŸ¥è¯†ç‚¹å¡ç‰‡ */
        .knowledge-box {
            background: #FFF3E0;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            border-left: 5px solid #FF9800;
            margin-bottom: 20px;
        }
        .knowledge-box h3 { margin: 0 0 10px 0; color: #E65100; border-bottom: 1px dashed #FFE0B2; padding-bottom: 5px; }
        .k-point { margin-bottom: 8px; font-size: 1em; line-height: 1.6; }
        .highlight { color: #C2185B; font-weight: bold; background: #F8BBD0; padding: 0 4px; border-radius: 3px; }
        .green-text { color: #2E7D32; font-weight: bold; }
        .red-text { color: #C62828; font-weight: bold; }

        /* SVG æ¼”ç¤ºåŒº */
        .svg-stage {
            background: #FFF;
            border: 2px dashed #FFB74D;
            border-radius: 10px;
            padding: 10px;
            margin: 15px 0;
            text-align: center;
            position: relative;
        }
        .svg-caption { font-size: 0.9em; color: #8D6E63; margin-top: 5px; font-style: italic; }

        .ctrl-btn {
            background: #FF9800; color: white; border: none; padding: 8px 20px; 
            border-radius: 20px; margin: 5px; cursor: pointer; font-size: 0.9em;
            box-shadow: 0 3px 0 #E65100; transition: 0.1s;
        }
        .ctrl-btn:active { transform: translateY(2px); box-shadow: 0 1px 0 #E65100; }
        .ctrl-btn.green { background: #8BC34A; box-shadow: 0 3px 0 #558B2F; }

        /* æŒ‰é’® */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 0;
            width: 100%;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 15px 0;
            font-weight: bold;
            box-shadow: 0 4px 0 #E65100;
            transition: 0.1s;
        }
        .btn:active { transform: translateY(3px); box-shadow: 0 1px 0 #E65100; }
        .btn-next { background: #8BC34A; box-shadow: 0 4px 0 #558B2F; }

        /* é¢˜ç›®åŒº */
        .progress-container { height: 10px; background: #EFEBE9; border-radius: 5px; margin-bottom: 5px; overflow: hidden; }
        .progress-bar { height: 100%; background: #FF9800; width: 0%; transition: width 0.3s; }
        
        .question-card { background: #FAFAFA; border-radius: 10px; padding: 15px; text-align: left; border: 2px solid #E0E0E0; margin-top: 10px; }
        .q-tag { background: #FFE0B2; color: #E65100; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; margin-right: 5px; }
        .q-content { font-size: 1.2em; font-weight: bold; margin: 10px 0 20px 0; line-height: 1.4; }

        /* é€‰é¡¹ */
        .option-item {
            background: white; border: 2px solid #FFCC80; padding: 12px; border-radius: 8px;
            margin-bottom: 10px; cursor: pointer; transition: 0.2s;
        }
        .option-item.selected { background: #FFE0B2; border-color: #F57C00; font-weight: bold; color: #E65100; }

        .fill-input { border: none; border-bottom: 3px solid #FF9800; background: transparent; width: 120px; text-align: center; font-size: 1.2em; color: #E65100; border-radius: 0; }

        /* æ’åº/æ‹–æ‹½é¢˜ */
        .sort-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .sort-item { 
            background: #FFF3E0; border: 1px solid #FF9800; color: #E65100;
            padding: 8px 12px; border-radius: 20px; font-size: 0.9em; cursor: pointer;
        }
        .sort-box { 
            min-height: 50px; border: 2px dashed #BDBDBD; border-radius: 8px; 
            margin-top: 10px; padding: 10px; display: flex; flex-wrap: wrap; gap: 8px;
            background: #FAFAFA; align-items: center;
        }
        .sort-placeholder { color: #999; font-size: 0.9em; width: 100%; text-align: center; }

        /* é”™é¢˜è§£æ */
        .wrong-item { background: #FFEBEE; border-left: 4px solid #EF5350; padding: 10px; margin-bottom: 10px; text-align: left; border-radius: 4px; }
        .score-display { font-size: 4em; color: #FF9800; font-weight: bold; margin: 10px 0; }

    </style>
</head>
<body>

    <!-- 1. å¤ä¹ åŒº -->
    <div id="section-review" class="container section active">
        <h1>ğŸ¥ª çŸ¥è¯†å¤ä¹ </h1>
        <p class="subtitle">ç¬¬äºŒå•å…ƒç¬¬å››è¯¾ï¼šä¸€å¤©çš„é£Ÿç‰©</p>

        <!-- çŸ¥è¯†ç‚¹ 1: èƒ½é‡æ¥æº -->
        <div class="knowledge-box">
            <h3>1. èƒ½é‡çš„æ¥æº</h3>
            <div class="k-point">âš¡ <strong>é¥®é£Ÿä¸å‘¼å¸</strong>ï¼šé™¤äº†å‘¼å¸ï¼Œé¥®é£Ÿæ˜¯æˆ‘ä»¬è·å–<span class="highlight">èƒ½é‡</span>çš„å¦ä¸€é‡è¦æ´»åŠ¨ã€‚</div>
            <div class="svg-stage">
                <svg width="100%" height="80" viewBox="0 0 300 80">
                    <!-- å‘¼å¸ -->
                    <text x="50" y="30" text-anchor="middle" font-size="12">å‘¼å¸</text>
                    <circle cx="50" cy="50" r="15" fill="#B3E5FC"/>
                    <text x="50" y="55" text-anchor="middle" font-size="20">ğŸŒ¬ï¸</text>
                    
                    <!-- é¥®é£Ÿ -->
                    <text x="250" y="30" text-anchor="middle" font-size="12">é¥®é£Ÿ</text>
                    <circle cx="250" cy="50" r="15" fill="#FFCCBC"/>
                    <text x="250" y="55" text-anchor="middle" font-size="20">ğŸ</text>

                    <!-- äººä½“èƒ½é‡ -->
                    <g transform="translate(150, 40)">
                        <rect x="-30" y="-15" width="60" height="30" rx="5" fill="#FFEB3B"/>
                        <text x="0" y="5" text-anchor="middle" font-size="12" font-weight="bold">èƒ½é‡</text>
                        <path d="M-60,0 L-35,0" stroke="#555" stroke-width="2" marker-end="url(#arrow)"/>
                        <path d="M60,0 L35,0" stroke="#555" stroke-width="2" marker-end="url(#arrow)"/>
                    </g>
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>

        <!-- çŸ¥è¯†ç‚¹ 2,3,6,8: åˆ†ç±»æ–¹æ³• -->
        <div class="knowledge-box">
            <h3>2. ç»™é£Ÿç‰©åˆ†åˆ†ç±»</h3>
            <div class="k-point">ğŸŒ¿ <strong>æŒ‰æ¥æº</strong>ï¼š
                <br>- <span class="green-text">æ¤ç‰©ç±» (ç´ é£Ÿ)</span>ï¼šè°·ç‰©ã€æœè”¬...
                <br>- <span class="red-text">åŠ¨ç‰©ç±» (è¤é£Ÿ)</span>ï¼šè‚‰ã€è›‹ã€å¥¶...
            </div>
            <div class="k-point">ğŸš <strong>æŒ‰ç”Ÿæ´»ä¹ æƒ¯</strong>ï¼šç²®é£Ÿã€è”¬èœã€è‚‰ç±»ã€å¥¶åˆ¶å“ã€è°ƒå‘³å“ç­‰ã€‚</div>
            <div class="k-point">ğŸ’¡ <strong>å¤šé‡åˆ†ç±»</strong>ï¼šåŒä¸€ç§é£Ÿç‰©å¯ä»¥æŒ‰ä¸åŒæ ‡å‡†åˆ†åˆ°ä¸åŒç±»åˆ«é‡Œã€‚</div>
            
            <div class="svg-stage">
                <svg width="100%" height="140" viewBox="0 0 300 140">
                    <!-- ä¸­å¿ƒé£Ÿç‰© -->
                    <circle cx="150" cy="70" r="30" fill="#FFF9C4" stroke="#FBC02D"/>
                    <text x="150" y="75" text-anchor="middle" font-size="12">é¸¡è›‹</text>
                    
                    <!-- åˆ†ç±»è¿çº¿ -->
                    <line x1="150" y1="40" x2="150" y2="10" stroke="#555" stroke-dasharray="4"/>
                    <text x="150" y="10" text-anchor="middle" font-size="10" fill="#D84315">æŒ‰æ¥æº: åŠ¨ç‰©ç±»</text>

                    <line x1="120" y1="70" x2="50" y2="70" stroke="#555" stroke-dasharray="4"/>
                    <text x="50" y="65" text-anchor="middle" font-size="10" fill="#D84315">æŒ‰ä¹ æƒ¯: è›‹ç±»</text>

                    <line x1="180" y1="70" x2="250" y2="70" stroke="#555" stroke-dasharray="4"/>
                    <text x="250" y="65" text-anchor="middle" font-size="10" fill="#D84315">æŒ‰ç”Ÿç†Ÿ: ç†Ÿé£Ÿ(ç…®)</text>
                    
                    <line x1="150" y1="100" x2="150" y2="130" stroke="#555" stroke-dasharray="4"/>
                    <text x="150" y="135" text-anchor="middle" font-size="10" fill="#D84315">æŒ‰ä¸»å‰¯: å‰¯é£Ÿ</text>
                </svg>
                <div class="svg-caption">åŒä¸€ç§é£Ÿç‰©æœ‰å¤šç§åˆ†ç±»</div>
            </div>
        </div>

        <!-- çŸ¥è¯†ç‚¹ 4 & 5: ç”Ÿé£Ÿä¸ç†Ÿé£Ÿ -->
        <div class="knowledge-box">
            <h3>3. ç”Ÿé£Ÿä¸ç†Ÿé£Ÿ</h3>
            <div class="k-point">ğŸ”¥ <strong>ç†Ÿé£Ÿ</strong>ï¼šè‚‰ç±»ã€é¦’å¤´ï¼ˆå¿…é¡»ç…®ç†Ÿæ€èŒã€åŠ©æ¶ˆåŒ–ï¼‰ã€‚</div>
            <div class="k-point">ğŸ¥— <strong>ç”Ÿé£Ÿ</strong>ï¼šæ°´æœã€é»„ç“œï¼ˆä¿æŒç»´ç”Ÿç´ ï¼‰ã€‚</div>
            <div class="k-point">ğŸ… <strong>ä¸¤æ –</strong>ï¼šè¥¿çº¢æŸ¿ï¼ˆå¯ç”Ÿåƒç³–æ‹Œï¼Œä¹Ÿå¯ç†Ÿåƒè›‹æ±¤ï¼‰ã€‚</div>
            
            <div class="svg-stage">
                <div style="display:flex; justify-content:space-around;">
                    <svg width="80" height="80">
                        <circle cx="40" cy="40" r="30" fill="#81C784"/>
                        <text x="40" y="45" text-anchor="middle" fill="white">ç”Ÿé£Ÿ</text>
                        <text x="40" y="65" text-anchor="middle" font-size="8">è‹¹æœ/é»„ç“œ</text>
                    </svg>
                    <svg width="80" height="80">
                        <rect x="10" y="10" width="60" height="60" rx="10" fill="#EF5350"/>
                        <text x="40" y="45" text-anchor="middle" fill="white">ç†Ÿé£Ÿ</text>
                        <text x="40" y="65" text-anchor="middle" font-size="8">çŒªè‚‰/ç±³é¥­</text>
                    </svg>
                    <svg width="80" height="80">
                        <path d="M40,10 L70,70 L10,70 Z" fill="#FFCA28"/>
                        <text x="40" y="50" text-anchor="middle" fill="#3E2723">å‡å¯</text>
                        <text x="40" y="65" text-anchor="middle" font-size="8">è¥¿çº¢æŸ¿</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- çŸ¥è¯†ç‚¹ 7: è®°å½•æ–¹æ³• -->
        <div class="knowledge-box">
            <h3>4. æ€æ ·è®°å½•é£Ÿç‰©ï¼Ÿ</h3>
            <div class="k-point">ğŸ“ <strong>æ‹†åˆ†è®°å½•</strong>ï¼šæ··åˆé£Ÿç‰©è¦æ‹†å¼€è®°ã€‚
                <br>ä¾‹å¦‚ï¼š<span class="highlight">è›‹ç‚’é¥­</span> = é¸¡è›‹ + ç±³é¥­
            </div>
            <div class="svg-stage">
                <svg width="100%" height="100" viewBox="0 0 300 100">
                    <!-- è›‹ç‚’é¥­ -->
                    <ellipse cx="60" cy="50" rx="40" ry="25" fill="#FFE082" stroke="#FFB300"/>
                    <text x="60" y="55" text-anchor="middle" font-size="12">è›‹ç‚’é¥­</text>
                    
                    <!-- ç®­å¤´ -->
                    <path d="M110,50 L140,50" stroke="#555" stroke-width="2" marker-end="url(#arrow)"/>
                    
                    <!-- æ‹†åˆ†ç»“æœ -->
                    <circle cx="180" cy="50" r="20" fill="#FFF9C4" stroke="#FBC02D"/>
                    <text x="180" y="55" text-anchor="middle" font-size="10">é¸¡è›‹</text>
                    <text x="215" y="55" font-size="12">+</text>
                    <circle cx="250" cy="50" r="20" fill="#F5F5F5" stroke="#BDBDBD"/>
                    <text x="250" y="55" text-anchor="middle" font-size="10">ç±³é¥­</text>
                </svg>
                <div class="svg-caption">è®°ä¸º2ç§é£Ÿç‰©</div>
            </div>
        </div>

        <button class="btn" onclick="startQuiz()">è¿›å…¥35é¢˜é—¯å…³å¡”ï¼ğŸš€</button>
    </div>

    <!-- 2. é—¯å…³åŒº -->
    <div id="section-quiz" class="container section">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div style="text-align:right; font-size:0.9em; color:#E65100;">é¢˜ç›®ï¼š<span id="q-index">1</span> / 35</div>

        <div id="question-area"></div>
        
        <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â–¶</button>
    </div>

    <!-- 3. ç»“ç®—åŒº -->
    <div id="section-result" class="container section">
        <h1>ğŸ† é—¯å…³æˆç»©</h1>
        <div class="score-display"><span id="final-score">0</span>åˆ†</div>
        <p id="reward-text"></p>
        
        <div id="wrong-list" style="display:none;">
            <h3 style="color:#D32F2F;">âŒ é”™é¢˜è§£æ</h3>
            <!-- é”™é¢˜å†…å®¹ -->
        </div>
        <button class="btn" onclick="location.reload()">ğŸ”„ é‡æ–°æŒ‘æˆ˜</button>
    </div>

    <script>
        // --- 35é“é¢˜åº“ ---
        const quizData = [
            // 1. èƒ½é‡ä¸é‡è¦æ€§ (5é¢˜)
            { type: 'mcq', q: 'é™¤äº†å‘¼å¸ï¼Œæˆ‘ä»¬ä»å¤–ç•Œè·å¾—èƒ½é‡çš„å¦ä¸€é‡è¦æ´»åŠ¨æ˜¯ï¼Ÿ', opts: ['ç¡çœ ', 'è¿åŠ¨', 'é¥®é£Ÿ'], a: 2, exp: 'é¥®é£Ÿæ‘„å…¥èƒ½é‡ã€‚' },
            { type: 'mcq', q: 'äººä½“çš„èƒ½é‡ä¸»è¦æ¥è‡ªï¼Ÿ', opts: ['é£Ÿç‰©', 'ç©ºæ°”', 'æ°´'], a: 0, exp: 'é£Ÿç‰©æä¾›åŒ–å­¦èƒ½ã€‚' },
            { type: 'fill', q: 'æˆ‘ä»¬æ¯å¤©éƒ½è¦åƒé£Ÿç‰©ï¼Œæ˜¯ä¸ºäº†è·å¾—____ã€‚', a: ['èƒ½é‡', 'è¥å…»'], exp: 'ç»´æŒç”Ÿå‘½æ´»åŠ¨ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å…³äºé¥®é£Ÿçš„è¯´æ³•ï¼Œæ­£ç¡®çš„æ˜¯ï¼Ÿ', opts: ['æƒ³åƒå¤šå°‘åƒå¤šå°‘', 'åªåƒå–œæ¬¢çš„', 'åˆç†æ­é…ï¼Œå‡è¡¡é¥®é£Ÿ'], a: 2, exp: 'å¥åº·é¥®é£ŸåŸåˆ™ã€‚' },
            { type: 'mcq', q: 'å¦‚æœä¸åƒæ—©é¤ï¼Œæˆ‘ä»¬ä¸Šè¯¾æ—¶å¯èƒ½ä¼šï¼Ÿ', opts: ['æ›´æœ‰ç²¾ç¥', 'å¤´æ™•æ— åŠ›', 'æ²¡æ„Ÿè§‰'], a: 1, exp: 'èƒ½é‡ä¸è¶³ã€‚' },

            // 2. é£Ÿç‰©åˆ†ç±» (10é¢˜)
            { type: 'mcq', q: 'æŒ‰æ¥æºåˆ†ï¼Œç‰›è‚‰å±äºï¼Ÿ', opts: ['æ¤ç‰©ç±»', 'åŠ¨ç‰©ç±»', 'è°ƒå‘³å“'], a: 1, exp: 'è‚‰ç±»æ¥è‡ªæœ¬èº«ã€‚' },
            { type: 'mcq', q: 'æŒ‰æ¥æºåˆ†ï¼Œç±³é¥­å±äºï¼Ÿ', opts: ['æ¤ç‰©ç±»', 'åŠ¨ç‰©ç±»', 'çŸ¿ç‰©ç±»'], a: 0, exp: 'æ°´ç¨»æ˜¯æ¤ç‰©ã€‚' },
            { type: 'sort', q: 'è¯·å°†ä¸‹åˆ—é£Ÿç‰©æŒ‰æ¥æºåˆ†ç±»(å…ˆæ¤ç‰©ååŠ¨ç‰©)ï¼š', items: ['ç™½èœ', 'é¸¡è›‹', 'è‹¹æœ'], answerOrder: ['ç™½èœ', 'è‹¹æœ', 'é¸¡è›‹'], exp: 'ç™½èœè‹¹æœæ˜¯æ¤ç‰©ï¼Œé¸¡è›‹æ˜¯åŠ¨ç‰©ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—é£Ÿç‰©ä¸­ï¼Œå±äºä¸»é£Ÿçš„æ˜¯ï¼Ÿ', opts: ['çº¢çƒ§è‚‰', 'é¦’å¤´', 'é’èœ'], a: 1, exp: 'é¦’å¤´é¢é£Ÿä¸ºä¸»é£Ÿã€‚' },
            { type: 'mcq', q: 'æ ¹æ®ç”Ÿæ´»ä¹ æƒ¯ï¼Œç‰›å¥¶é€šå¸¸è¢«å½’ä¸ºï¼Ÿ', opts: ['è‚‰ç±»', 'è”¬èœ', 'å¥¶åˆ¶å“'], a: 2, exp: 'ç”Ÿæ´»ä¹ æƒ¯åˆ†ç±»æ³•ã€‚' },
            { type: 'mcq', q: 'æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸åŒçš„____ç»™é£Ÿç‰©åˆ†ç±»ã€‚', opts: ['ä»·æ ¼', 'æ ‡å‡†', 'é‡é‡'], a: 1, exp: 'æ ‡å‡†ä¸åŒï¼Œç±»åˆ«ä¸åŒã€‚' },
            { type: 'mcq', q: 'åŒä¸€ç§é£Ÿç‰©ï¼ˆå¦‚é»„ç“œï¼‰____è¢«åˆ†åˆ°ä¸åŒçš„ç±»åˆ«é‡Œã€‚', opts: ['å¯ä»¥', 'ä¸å¯ä»¥'], a: 0, exp: 'æ—¢æ˜¯è”¬èœä¹Ÿæ˜¯æ¤ç‰©ç±»ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å±äºç´ é£Ÿï¼ˆæ¤ç‰©ç±»ï¼‰çš„æ˜¯ï¼Ÿ', opts: ['è±†è…', 'ç«è…¿', 'é…¸å¥¶'], a: 0, exp: 'è±†è…æ˜¯å¤§è±†åšçš„ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å±äºè¤é£Ÿï¼ˆåŠ¨ç‰©ç±»ï¼‰çš„æ˜¯ï¼Ÿ', opts: ['åœŸè±†', 'é±¼', 'èŠ±ç”Ÿ'], a: 1, exp: 'é±¼æ˜¯åŠ¨ç‰©ã€‚' },
            { type: 'fill', q: 'æŒ‰æ¥æºåˆ†ï¼Œé£Ÿç‰©å¯åˆ†ä¸ºæ¤ç‰©ç±»é£Ÿç‰©å’Œ____é£Ÿç‰©ã€‚', a: ['åŠ¨ç‰©ç±»', 'åŠ¨ç‰©'], exp: 'ä¸¤å¤§æ¥æºã€‚' },

            // 3. ç”Ÿé£Ÿä¸ç†Ÿé£Ÿ (8é¢˜)
            { type: 'mcq', q: 'ä¸‹åˆ—é£Ÿç‰©ä¸­ï¼Œé€šå¸¸å¿…é¡»ç…®ç†Ÿåƒçš„æ˜¯ï¼Ÿ', opts: ['é¦™è•‰', 'çŒªè‚‰', 'é»„ç“œ'], a: 1, exp: 'ç”Ÿè‚‰å«å¯„ç”Ÿè™«ç»†èŒã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—é£Ÿç‰©ä¸­ï¼Œé€‚åˆç”Ÿåƒçš„æ˜¯ï¼Ÿ', opts: ['å¤§ç±³', 'é¸¡è‚‰', 'æ¢¨'], a: 2, exp: 'æ°´æœé€‚åˆç”Ÿåƒã€‚' },
            { type: 'mcq', q: 'æ—¢å¯ä»¥ç”Ÿåƒï¼Œåˆå¯ä»¥ç†Ÿåƒçš„é£Ÿç‰©æ˜¯ï¼Ÿ', opts: ['è¥¿çº¢æŸ¿', 'åœŸè±†', 'ç‰›è‚‰'], a: 0, exp: 'è¥¿çº¢æŸ¿ä¸¤æ –ã€‚' },
            { type: 'mcq', q: 'é£Ÿç‰©ç…®ç†Ÿåï¼Œé€šå¸¸ä¼šï¼Ÿ', opts: ['è¥å…»å…¨æ²¡äº†', 'æ›´éš¾æ¶ˆåŒ–', 'æ›´æ˜“æ¶ˆåŒ–ï¼Œæ€ç­ç»†èŒ'], a: 2, exp: 'ç†Ÿé£Ÿçš„ä¼˜ç‚¹ã€‚' },
            { type: 'mcq', q: 'ç”Ÿåƒé£Ÿç‰©çš„å¥½å¤„æ˜¯ï¼Ÿ', opts: ['å‘³é“æ›´å¥½', 'å‡å°‘ç»´ç”Ÿç´ æŸå¤±', 'æ›´å«ç”Ÿ'], a: 1, exp: 'é«˜æ¸©ä¼šç ´åéƒ¨åˆ†ç»´ç”Ÿç´ ã€‚' },
            { type: 'sort', q: 'è¯·æŒ‰ç”Ÿé£Ÿã€ç†Ÿé£Ÿã€å‡å¯æ’åºï¼š', items: ['çŒªè‚‰', 'è‹¹æœ', 'èåœ'], answerOrder: ['è‹¹æœ', 'çŒªè‚‰', 'èåœ'], exp: 'è‹¹æœç”Ÿï¼ŒçŒªè‚‰ç†Ÿï¼Œèåœå‡å¯ã€‚' },
            { type: 'mcq', q: 'å‡‰æ‹Œé»„ç“œå±äºï¼Ÿ', opts: ['ç”Ÿé£Ÿ', 'ç†Ÿé£Ÿ'], a: 0, exp: 'æœªåŠ çƒ­ã€‚' },
            { type: 'mcq', q: 'ç”Ÿåƒè”¬èœæ°´æœæ—¶ï¼Œæœ€é‡è¦çš„æ³¨æ„äº‹é¡¹æ˜¯ï¼Ÿ', opts: ['æ´—å¹²å‡€', 'ç…®ç†Ÿ', 'å¤šæ”¾ç³–'], a: 0, exp: 'å«ç”Ÿå®‰å…¨ã€‚' },

            // 4. è®°å½•ç»Ÿè®¡ (7é¢˜)
            { type: 'mcq', q: 'è®°å½•ä¸€å¤©åƒçš„é£Ÿç‰©æ—¶ï¼Œè¿™é¡¿é¥­åƒçš„â€œç‰›è‚‰é¢â€åº”è¯¥è®°ä¸ºï¼Ÿ', opts: ['1ç§é£Ÿç‰©', '2ç§é£Ÿç‰©(ç‰›è‚‰+é¢)', 'ä¸è®°å½•'], a: 1, exp: 'æ··åˆé£Ÿç‰©æ‹†åˆ†è®°ã€‚' },
            { type: 'mcq', q: 'â€œç•ªèŒ„ç‚’è›‹â€åº”è¯¥è®°ä¸ºå‡ ç§é£Ÿç‰©ï¼Ÿ', opts: ['1ç§', '2ç§', '3ç§'], a: 1, exp: 'ç•ªèŒ„+è›‹ã€‚' },
            { type: 'mcq', q: 'ç»Ÿè®¡é£Ÿç‰©æ•°é‡æ—¶ï¼Œé›¶é£Ÿ____è®°å½•ã€‚', opts: ['ä¸éœ€è¦', 'éœ€è¦', 'çœ‹å¿ƒæƒ…'], a: 1, exp: 'å‡¡å…¥å£çš†éœ€è®°å½•ã€‚' },
            { type: 'mcq', q: 'ä¸€å¤©ä¸­å–çš„æ°´____é£Ÿç‰©ã€‚', opts: ['å±äº', 'ä¸å±äº'], a: 0, exp: 'æ°´ä¹Ÿæ˜¯äººä½“é‡è¦è¥å…»æ¥æºï¼Œå¹¿ä¹‰ä¸Šç®—ã€‚' },
            { type: 'fill', q: 'è®°å½•â€œå…«å®ç²¥â€æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠå®ƒ____æˆå¤šç§é£Ÿæè®°å½•ã€‚', a: ['æ‹†åˆ†', 'åˆ†è§£'], exp: 'æ‹†åˆ†è®°å½•æ³•ã€‚' },
            { type: 'mcq', q: 'å¦‚æœæ—©é¤åƒäº†2ä¸ªåŒ…å­ï¼Œè®°å½•æ—¶è®°ä¸ºï¼Ÿ', opts: ['åŒ…å­*2', 'åŒ…å­*1'], a: 0, exp: 'åŒç§é£Ÿç‰©è®°1æ¬¡æˆ–æ ‡æ•°é‡ï¼Œç§ç±»ç®—1ç§ã€‚' },
            { type: 'mcq', q: 'åšé£Ÿç‰©è®°å½•å¡ç‰‡æ—¶ï¼Œé‡å¤åƒçš„é£Ÿç‰©ï¼ˆå¦‚æ¯é¡¿éƒ½åƒç±³é¥­ï¼‰ï¼Ÿ', opts: ['ä¸ç”¨è®°', 'è¦åˆ†é¡¿è®°å½•', 'è®°ä¸€æ¬¡å°±è¡Œ'], a: 1, exp: 'ç»Ÿè®¡ä¸€å¤©æ€»é‡æ—¶éœ€åˆ†é¡¿æˆ–ç´¯è®¡ã€‚' },

            // 5. ç»¼åˆæ¢ç©¶ (5é¢˜)
            { type: 'mcq', q: 'ä¸‹åˆ—å±äºè°ƒå‘³å“çš„æ˜¯ï¼Ÿ', opts: ['ç±³é¥­', 'ç›/é…±æ²¹', 'è‹¹æœ'], a: 1, exp: 'è°ƒå‘³å“åˆ†ç±»ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—æ­é…ä¸­ï¼Œè¥å…»æ›´å‡è¡¡çš„æ˜¯ï¼Ÿ', opts: ['ç±³é¥­+çº¢çƒ§è‚‰', 'ç±³é¥­+é’èœ+é±¼', 'è–¯æ¡+å¯ä¹'], a: 1, exp: 'è¤ç´ æ­é…ã€‚' },
            { type: 'sort', q: 'è¯·æŒ‰ä¸»é£Ÿã€å‰¯é£Ÿæ’åˆ—ï¼š', items: ['ç±³é¥­', 'ç‚’é’èœ'], answerOrder: ['ç±³é¥­', 'ç‚’é’èœ'], exp: 'ç±³é¥­ä¸»é£Ÿã€‚' },
            { type: 'mcq', q: 'æˆ‘ä»¬åœ¨ç»™é£Ÿç‰©åˆ†ç±»æ—¶ï¼Œç¬¬ä¸€æ­¥åº”è¯¥æ˜¯ï¼Ÿ', opts: ['ç¡®å®šåˆ†ç±»æ ‡å‡†', 'éšä¾¿åˆ†', 'æ•°æ•°é‡'], a: 0, exp: 'æ ‡å‡†å…ˆè¡Œã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å…³äºâ€œä¸€å¤©çš„é£Ÿç‰©â€è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ', opts: ['é£Ÿç‰©ç§ç±»å¾ˆä¸°å¯Œ', 'æˆ‘ä»¬æ¯å¤©åƒå¾ˆå¤šç§é£Ÿç‰©', 'åªåƒè‚‰å°±å¤Ÿäº†'], a: 2, exp: 'éœ€å¤šæ ·åŒ–ã€‚' }
        ];

        // --- é€»è¾‘æ§åˆ¶ ---
        let currentQIndex = 0;
        let userScoreRaw = 0;
        let userMistakes = [];
        let selectedOption = null;
        let sortOrder = []; 

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;
            if (type === 'correct') {
                osc.frequency.setValueAtTime(600, now); osc.frequency.exponentialRampToValueAtTime(1200, now + 0.15);
                gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.15);
                osc.start(now); osc.stop(now + 0.15);
            } else if (type === 'wrong') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(150, now); osc.frequency.linearRampToValueAtTime(100, now + 0.2);
                gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            } else if (type === 'click') {
                osc.frequency.setValueAtTime(400, now); gain.gain.setValueAtTime(0.05, now); gain.gain.linearRampToValueAtTime(0, now + 0.05);
                osc.start(now); osc.stop(now + 0.05);
            }
        }

        function startQuiz() {
            document.getElementById('section-review').classList.remove('active');
            document.getElementById('section-quiz').classList.add('active');
            renderQuestion();
        }

        function renderQuestion() {
            const qData = quizData[currentQIndex];
            const area = document.getElementById('question-area');
            const nextBtn = document.getElementById('nextBtn');
            
            document.getElementById('q-index').innerText = currentQIndex + 1;
            document.getElementById('progressBar').style.width = ((currentQIndex) / quizData.length * 100) + "%";
            
            area.innerHTML = '';
            nextBtn.disabled = true; nextBtn.style.opacity = 0.5;
            selectedOption = null;
            sortOrder = [];

            const card = document.createElement('div');
            card.className = 'question-card';
            
            let tagText = qData.type === 'mcq' ? 'é€‰æ‹©é¢˜' : (qData.type === 'fill' ? 'å¡«ç©ºé¢˜' : 'æ’åºé¢˜');
            card.innerHTML = `<div class="q-content"><span class="q-tag">${tagText}</span>${qData.q}</div>`;

            if (qData.type === 'mcq') {
                qData.opts.forEach((opt, idx) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-item'; btn.innerText = opt;
                    btn.onclick = () => selectMCQ(btn, idx);
                    card.appendChild(btn);
                });
            } else if (qData.type === 'fill') {
                const input = document.createElement('input');
                input.className = 'fill-input'; input.type = 'text'; input.placeholder = 'è¾“å…¥ç­”æ¡ˆ';
                input.oninput = (e) => {
                    selectedOption = e.target.value.trim();
                    nextBtn.disabled = !selectedOption;
                    nextBtn.style.opacity = selectedOption ? 1 : 0.5;
                };
                card.appendChild(input);
            } else if (qData.type === 'sort') {
                renderSort(card, qData);
            }
            area.appendChild(card);
        }

        function selectMCQ(el, idx) {
            playSound('click');
            document.querySelectorAll('.option-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            selectedOption = idx;
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('nextBtn').style.opacity = 1;
        }

        function renderSort(card, qData) {
            const container = document.createElement('div');
            const sourceDiv = document.createElement('div'); sourceDiv.className = 'sort-container';
            const targetDiv = document.createElement('div'); targetDiv.className = 'sort-box';
            targetDiv.innerHTML = '<div class="sort-placeholder">ç‚¹å‡»é€‰é¡¹æŒ‰é¡ºåºæ’åˆ—</div>';

            let items = [...qData.items].sort(()=>Math.random()-0.5);
            
            items.forEach(item => {
                const btn = document.createElement('div');
                btn.className = 'sort-item';
                btn.innerText = item;
                btn.onclick = () => {
                    playSound('click');
                    if(targetDiv.contains(btn)) {
                        sourceDiv.appendChild(btn);
                        sortOrder = sortOrder.filter(i => i !== item);
                    } else {
                        if(targetDiv.querySelector('.sort-placeholder')) targetDiv.innerHTML = '';
                        targetDiv.appendChild(btn);
                        sortOrder.push(item);
                    }
                    if(sortOrder.length === qData.items.length) {
                         document.getElementById('nextBtn').disabled = false;
                         document.getElementById('nextBtn').style.opacity = 1;
                    } else {
                         document.getElementById('nextBtn').disabled = true;
                         document.getElementById('nextBtn').style.opacity = 0.5;
                    }
                };
                sourceDiv.appendChild(btn);
            });

            container.appendChild(sourceDiv); container.appendChild(targetDiv);
            card.appendChild(container);
        }

        function nextQuestion() {
            const qData = quizData[currentQIndex];
            let isCorrect = false;
            let myAns = "";

            if (qData.type === 'mcq') {
                if (selectedOption === qData.a) isCorrect = true;
                myAns = qData.opts[selectedOption];
            } else if (qData.type === 'fill') {
                if (qData.a.some(ans => selectedOption.includes(ans))) isCorrect = true;
                myAns = selectedOption;
            } else if (qData.type === 'sort') {
                if (JSON.stringify(sortOrder) === JSON.stringify(qData.answerOrder)) isCorrect = true;
                myAns = sortOrder.join(' -> ');
            }

            if (isCorrect) {
                userScoreRaw++;
                playSound('correct');
            } else {
                playSound('wrong');
                userMistakes.push({ q: qData.q, my: myAns, exp: qData.exp });
            }

            currentQIndex++;
            if (currentQIndex < quizData.length) renderQuestion();
            else showResults();
        }

        function showResults() {
            document.getElementById('section-quiz').classList.remove('active');
            document.getElementById('section-result').classList.add('active');
            
            let finalScore = Math.round((userScoreRaw / quizData.length) * 100);
            let temp = 0;
            const scoreEl = document.getElementById('final-score');
            const timer = setInterval(() => {
                if(temp >= finalScore) { clearInterval(timer); scoreEl.innerText = finalScore; }
                else { temp++; scoreEl.innerText = temp; }
            }, 20);

            const reward = document.getElementById('reward-text');
            if(finalScore === 100) reward.innerText = "ğŸ‰ å®Œç¾ï¼ä½ æ˜¯ç¾é£Ÿåˆ†ç±»ä¸“å®¶ï¼";
            else if(finalScore >= 80) reward.innerText = "ğŸŒŸ ä¼˜ç§€ï¼å¯¹é£Ÿç‰©å¾ˆäº†è§£ï¼";
            else reward.innerText = "ğŸ’ª åŠ æ²¹ï¼åƒé¥­æ—¶å¤šè§‚å¯Ÿä¸€ä¸‹ï¼";

            if (userMistakes.length > 0) {
                const list = document.getElementById('wrong-list');
                list.style.display = 'block';
                let html = '';
                userMistakes.forEach((m, i) => {
                    html += `<div class="wrong-item"><strong>${i+1}. ${m.q}</strong><br><span style="font-size:0.9em; color:#D32F2F">ä½ çš„å›ç­”ï¼š${m.my}</span><br><span style="font-size:0.9em; color:#388E3C">ğŸ’¡ è§£æï¼š${m.exp}</span></div>`;
                });
                list.innerHTML += html;
            }
        }
    </script>
</body>
</html>