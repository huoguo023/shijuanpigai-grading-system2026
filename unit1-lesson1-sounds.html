<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬ä¸€å•å…ƒç¬¬ä¸€è¯¾ï¼šå¤ä¹ ä¸35é¢˜å¤§é—¯å…³</title>
    <style>
        :root {
            --bg-color: #E0F7FA;
            --card-bg: #FFFFFF;
            --primary: #4DD0E1; 
            --secondary: #FFAB91; 
            --text: #455A64; /* åŠ æ·±å­—ä½“é¢œè‰²ï¼Œæ›´æ¸…æ™° */
            --font-main: "Microsoft YaHei", -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * {
            box-sizing: border-box; /* å…³é”®ä¿®å¤ï¼šé˜²æ­¢å¸ƒå±€è¢«å†…è¾¹è·æ’‘ç ´ */
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text);
            margin: 0;
            padding: 10px; /* æ‰‹æœºç«¯å‡å°‘å¤–è¾¹è· */
            min-height: 100vh;
            background-image: radial-gradient(#B2EBF2 15%, transparent 16%);
            background-size: 30px 30px;
            /* ä¿®å¤æ ¸å¿ƒï¼šç§»é™¤ display: flexï¼Œæ”¹ç”¨é»˜è®¤å¸ƒå±€ */
            display: block; 
        }

        .container {
            width: 100%;
            max-width: 800px; /* ç”µè„‘ä¸Šé™åˆ¶æœ€å¤§å®½åº¦ */
            margin: 0 auto; /* å±…ä¸­æ˜¾ç¤º */
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 20px; /* å†…éƒ¨é—´è·é€‚ä¸­ */
            text-align: center;
            border: 4px solid #B2EBF2;
            overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */
        }

        /* æ ‡é¢˜é€‚é… */
        h1 { 
            color: #00ACC1; 
            margin-top: 0;
            margin-bottom: 10px; 
            font-size: 1.8em; /* æ‰‹æœºä¸Šå­—ä½“ç¨å¾®è°ƒå° */
        }
        .subtitle { color: #FF7043; font-size: 1em; margin-bottom: 20px; }

        /* åŒºåŸŸåˆ‡æ¢åŠ¨ç”» */
        .section { display: none; animation: fadeIn 0.3s ease-out; }
        .active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æŒ‰é’®ä¼˜åŒ– */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 0; /* ä¸Šä¸‹æ’‘å¼€ï¼Œå·¦å³è‡ªåŠ¨ */
            width: 100%; /* æ‰‹æœºä¸ŠæŒ‰é’®å æ»¡ä¸€è¡Œï¼Œæ›´æ˜“ç‚¹å‡» */
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: bold;
            box-shadow: 0 4px 0 #0097A7;
            transition: 0.1s;
            -webkit-tap-highlight-color: transparent;
        }
        .btn:active { transform: translateY(3px); box-shadow: 0 1px 0 #0097A7; }
        .btn-next { background: #FFAB91; box-shadow: 0 4px 0 #D84315; }
        .btn-next:active { box-shadow: 0 1px 0 #D84315; }

        /* çŸ¥è¯†ç‚¹å¡ç‰‡ */
        .knowledge-box {
            background: #FFFDE7;
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            border-left: 5px solid #FBC02D;
            margin-bottom: 15px;
        }
        .knowledge-box h3 { margin-top: 0; color: #F57F17; }
        .knowledge-box p { margin: 8px 0; line-height: 1.6; }

        /* SVG å®¹å™¨è‡ªé€‚åº” */
        .svg-stage {
            background: #E1F5FE;
            border-radius: 10px;
            padding: 10px;
            margin: 15px 0;
            border: 2px dashed #4FC3F7;
            width: 100%;
            overflow-x: auto; /* å¦‚æœå›¾ç‰‡å®åœ¨å¤ªå®½ï¼Œå…è®¸æ¨ªå‘æ»‘åŠ¨ */
        }

        /* é¢˜ç›®å¡ç‰‡ */
        .question-card {
            background: #FAFAFA;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            border: 2px solid #EEE;
        }
        .q-tag {
            background: #E0F2F1; color: #00695C; padding: 3px 6px; 
            border-radius: 4px; font-size: 0.8em; font-weight: bold;
            display: inline-block; margin-bottom: 5px;
        }
        .q-text { font-size: 1.2em; margin: 10px 0 20px 0; line-height: 1.5; font-weight: bold; color: #37474F; }

        /* é€‰é¡¹æ ·å¼ */
        .options-grid { display: flex; flex-direction: column; gap: 10px; }
        .option-item {
            background: white;
            border: 2px solid #CFD8DC;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            line-height: 1.4;
            -webkit-tap-highlight-color: transparent; /* å»é™¤æ‰‹æœºç‚¹å‡»é«˜äº®èƒŒæ™¯ */
        }
        .option-item.selected { background: #B2EBF2; border-color: #00BCD4; font-weight: bold; }

        /* è¿›åº¦æ¡ */
        .progress-container {
            height: 10px; background: #ECEFF1; border-radius: 5px; margin-bottom: 10px; overflow: hidden;
        }
        .progress-bar { height: 100%; background: #4DD0E1; width: 0%; transition: width 0.3s; }

        /* å¡«ç©ºé¢˜è¾“å…¥æ¡† */
        .fill-input {
            font-size: 1.2em; padding: 10px; width: 100%; 
            border: 3px solid #B2EBF2; border-radius: 8px; text-align: center;
            outline: none; -webkit-appearance: none;
        }

        /* é”™é¢˜æœ¬ */
        .wrong-card {
            background: #FFEBEE; border-left: 5px solid #EF5350;
            padding: 10px; margin-bottom: 10px; text-align: left; border-radius: 5px;
        }
        .score-big { font-size: 3.5em; color: #FF7043; font-weight: bold; margin: 10px 0; }

    </style>
</head>
<body>

    <!-- å³æ—¶åé¦ˆç³»ç»Ÿ -->
    <style>
    .feedback-toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px); background: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 8px 30px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 12px; z-index: 10000; opacity: 0; transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55); font-size: 1.1rem; font-weight: bold; }
    .feedback-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
    .feedback-success { border: 3px solid #4CAF50; color: #2E7D32; }
    .feedback-error { border: 3px solid #FF9800; color: #E65100; }
    .toast-icon { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: bold; }
    .feedback-success .toast-icon { background: #4CAF50; color: white; }
    .feedback-error .toast-icon { background: #FF9800; color: white; }
    .confetti { position: fixed; width: 10px; height: 10px; z-index: 9999; pointer-events: none; }
    @keyframes confetti-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    @keyframes correct-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); } 20%, 40%, 60%, 80% { transform: translateX(8px); } }
    .option-item.correct-feedback { animation: correct-pulse 0.6s; background: #E8F5E9 !important; border-color: #4CAF50 !important; box-shadow: 0 0 20px rgba(76, 175, 80, 0.3) !important; }
    .option-item.wrong-feedback { animation: shake 0.5s; background: #FFF3E0 !important; border-color: #FF9800 !important; }
    .fill-input.correct-feedback { animation: correct-pulse 0.6s; background: #E8F5E9 !important; border-color: #4CAF50 !important; }
    .fill-input.wrong-feedback { animation: shake 0.5s; background: #FFF3E0 !important; border-color: #FF9800 !important; }
    </style>

    <!-- 1. å¤ä¹ åŒº -->
    <div id="section-review" class="container section active">
        <h1>ğŸ“– çŸ¥è¯†å¤ä¹ </h1>
        <p class="subtitle">å¬å¬å£°éŸ³ Â· ç¬¬ä¸€è¯¾</p>

        <div class="knowledge-box">
            <h3>ğŸµ é‡ç‚¹1ï¼šå£°éŸ³çš„åˆ†ç±»</h3>
            <p>ğŸ¶ <strong>åŠ¨ç‰©å«å£°</strong>ï¼šç‹—å«ã€çŒ«å«ã€é¸Ÿå«ç­‰ã€‚</p>
            <p>ğŸŒ§ï¸ <strong>è‡ªç„¶å£°éŸ³</strong>ï¼šé£å£°ã€é›¨å£°ã€é›·å£°ã€æµæ°´ã€‚</p>
            <p>ğŸš— <strong>äººç±»æ´»åŠ¨</strong>ï¼šè¯»ä¹¦ã€å”±æ­Œã€æœºå™¨å£°ã€æ±½è½¦ã€‚</p>
        </div>

        <div class="knowledge-box">
            <h3>ğŸµ é‡ç‚¹2ï¼šéŸ³ç¬¦ä¸éŸ³å‰ (åŠ¨ç”»æ¼”ç¤º)</h3>
            
            <!-- 1. ä¸ƒä¸ªéŸ³ç¬¦æ¼”ç¤º -->
            <div class="svg-stage">
                <p style="font-weight:bold; color:#0277BD; margin-bottom:5px;">ğŸ¹ éŸ³ç¬¦é«˜ä½ï¼šæ•°å­—è¶Šå¤§ï¼Œå£°éŸ³è¶Šé«˜</p>
                <svg width="100%" height="180" viewBox="0 0 380 180" preserveAspectRatio="xMidYMid meet" style="background:linear-gradient(to bottom, #E3F2FD 0%, #F5F5F5 100%); border-radius:10px;">
                    <defs>
                        <linearGradient id="staffGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#90A4AE; stop-opacity:0.3"/>
                            <stop offset="100%" style="stop-color:#CFD8DC; stop-opacity:0.3"/>
                        </linearGradient>
                        <radialGradient id="note1"><stop offset="0%" style="stop-color:#FFCDD2"/><stop offset="100%" style="stop-color:#EF5350"/></radialGradient>
                        <radialGradient id="note2"><stop offset="0%" style="stop-color:#FFCCBC"/><stop offset="100%" style="stop-color:#FF7043"/></radialGradient>
                        <radialGradient id="note3"><stop offset="0%" style="stop-color:#FFE082"/><stop offset="100%" style="stop-color:#FFCA28"/></radialGradient>
                        <radialGradient id="note4"><stop offset="0%" style="stop-color:#C5E1A5"/><stop offset="100%" style="stop-color:#66BB6A"/></radialGradient>
                        <radialGradient id="note5"><stop offset="0%" style="stop-color:#90CAF9"/><stop offset="100%" style="stop-color:#42A5F5"/></radialGradient>
                        <radialGradient id="note6"><stop offset="0%" style="stop-color:#B39DDB"/><stop offset="100%" style="stop-color:#5C6BC0"/></radialGradient>
                        <radialGradient id="note7"><stop offset="0%" style="stop-color:#CE93D8"/><stop offset="100%" style="stop-color:#AB47BC"/></radialGradient>
                    </defs>
                    
                    <!-- äº”çº¿è°±èƒŒæ™¯ -->
                    <line x1="30" y1="140" x2="350" y2="140" stroke="url(#staffGrad)" stroke-width="1"/>
                    <line x1="30" y1="130" x2="350" y2="130" stroke="url(#staffGrad)" stroke-width="1"/>
                    <line x1="30" y1="120" x2="350" y2="120" stroke="url(#staffGrad)" stroke-width="1"/>
                    <line x1="30" y1="110" x2="350" y2="110" stroke="url(#staffGrad)" stroke-width="1"/>
                    <line x1="30" y1="100" x2="350" y2="100" stroke="url(#staffGrad)" stroke-width="1"/>
                    
                    <!-- è¶‹åŠ¿çº¿ -->
                    <polyline points="40,140 90,120 140,100 190,80 240,60 290,40 340,20" fill="none" stroke="#B0BEC5" stroke-width="2" stroke-dasharray="5,5"/>
                    
                    <!-- éŸ³ç¬¦ç»„ (å¸¦æµ®åŠ¨åŠ¨ç”») -->
                    <g transform="translate(40,140)">
                        <circle r="17" fill="url(#note1)" stroke="#C62828" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">1</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Do</text>
                    </g>
                    <g transform="translate(90,120)">
                        <circle r="17" fill="url(#note2)" stroke="#D84315" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="0.3s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">2</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Re</text>
                    </g>
                    <g transform="translate(140,100)">
                        <circle r="17" fill="url(#note3)" stroke="#F57C00" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="0.6s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">3</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Mi</text>
                    </g>
                    <g transform="translate(190,80)">
                        <circle r="17" fill="url(#note4)" stroke="#388E3C" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="0.9s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">4</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Fa</text>
                    </g>
                    <g transform="translate(240,60)">
                        <circle r="17" fill="url(#note5)" stroke="#1976D2" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="1.2s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">5</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Sol</text>
                    </g>
                    <g transform="translate(290,40)">
                        <circle r="17" fill="url(#note6)" stroke="#303F9F" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="1.5s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">6</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">La</text>
                    </g>
                    <g transform="translate(340,20)">
                        <circle r="17" fill="url(#note7)" stroke="#7B1FA2" stroke-width="2">
                            <animate attributeName="cy" values="0;-5;0" dur="2s" begin="1.8s" repeatCount="indefinite"/>
                        </circle>
                        <text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="16">7</text>
                        <text y="30" text-anchor="middle" font-size="11" fill="#555" font-weight="bold">Si</text>
                    </g>

                    <!-- æ ‡æ³¨ -->
                    <text x="10" y="150" font-size="13" fill="#666" font-weight="bold">ä½éŸ³</text>
                    <text x="350" y="25" font-size="13" fill="#666" font-weight="bold">é«˜éŸ³</text>
                    
                    <!-- ç®­å¤´ -->
                    <path d="M15,145 L15,155" fill="none" stroke="#888" stroke-width="2" marker-end="url(#arrowDown)"/>
                    <path d="M365,30 L365,20" fill="none" stroke="#888" stroke-width="2" marker-end="url(#arrowUp)"/>
                    <defs>
                        <marker id="arrowDown" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <path d="M0,0 L10,5 L0,10 L3,5 z" fill="#888"/>
                        </marker>
                        <marker id="arrowUp" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <path d="M0,10 L10,5 L0,0 L3,5 z" fill="#888"/>
                        </marker>
                    </defs>
                </svg>
            </div>

            <!-- 2. éŸ³å‰æŒ¯åŠ¨æ¼”ç¤º -->
            <div class="svg-stage">
                <p style="font-weight:bold; color:#E65100; margin-bottom:5px;">ğŸ”¨ éŸ³å‰çš„ç§˜å¯†ï¼šæ­£åœ¨æŒ¯åŠ¨</p>
                <svg width="100%" height="160" viewBox="0 0 300 160" preserveAspectRatio="xMidYMid meet" style="background:linear-gradient(to bottom, #FFF3E0 0%, #F5F5F5 100%); border-radius:10px;">
                    <defs>
                        <linearGradient id="forkGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#CFD8DC"/>
                            <stop offset="50%" style="stop-color:#90A4AE"/>
                            <stop offset="100%" style="stop-color:#78909C"/>
                        </linearGradient>
                        <linearGradient id="handleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#90A4AE"/>
                            <stop offset="100%" style="stop-color:#546E7A"/>
                        </linearGradient>
                        <radialGradient id="forkHighlight">
                            <stop offset="0%" style="stop-color:#ECEFF1; stop-opacity:0.8"/>
                            <stop offset="100%" style="stop-color:#B0BEC5; stop-opacity:0"/>
                        </radialGradient>
                    </defs>
                    
                    <!-- éŸ³å‰åº•åº§é˜´å½± -->
                    <ellipse cx="150" cy="152" rx="10" ry="3" fill="#263238" opacity="0.3"/>
                    
                    <!-- éŸ³å‰æ‰‹æŸ„ (ç«‹ä½“) -->
                    <rect x="142" y="90" width="16" height="65" rx="8" fill="url(#handleGrad)" stroke="#37474F" stroke-width="1"/>
                    <!-- æ‰‹æŸ„é«˜å…‰ -->
                    <rect x="144" y="95" width="4" height="50" rx="2" fill="white" opacity="0.3"/>
                    
                    <!-- éŸ³å‰å‰ä½“ (é‡‘å±è´¨æ„Ÿ) -->
                    <path d="M120,20 L120,90 Q120,110 150,110 Q180,110 180,90 L180,20" fill="url(#forkGrad)" stroke="#546E7A" stroke-width="3" stroke-linecap="round"/>
                    <!-- å‰ä½“å†…ä¾§é˜´å½± -->
                    <path d="M125,25 L125,88 Q125,105 150,105 Q175,105 175,88 L175,25" fill="none" stroke="#455A64" stroke-width="2" opacity="0.4"/>
                    <!-- å‰ä½“é«˜å…‰ -->
                    <ellipse cx="135" cy="50" rx="8" ry="30" fill="url(#forkHighlight)"/>
                    <ellipse cx="165" cy="50" rx="8" ry="30" fill="url(#forkHighlight)"/>
                    
                    <!-- æŒ¯åŠ¨è™šå½± (å·¦å‰) -->
                    <path d="M115,20 L115,90" fill="none" stroke="#FFAB91" stroke-width="5" opacity="0.5" stroke-linecap="round">
                        <animate attributeName="d" values="M115,20 L115,90; M125,20 L125,90; M115,20 L115,90" dur="0.08s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.5;0.3;0.5" dur="0.08s" repeatCount="indefinite"/>
                    </path>
                    <!-- æŒ¯åŠ¨è™šå½± (å³å‰) -->
                    <path d="M185,20 L185,90" fill="none" stroke="#FFAB91" stroke-width="5" opacity="0.5" stroke-linecap="round">
                        <animate attributeName="d" values="M185,20 L185,90; M175,20 L175,90; M185,20 L185,90" dur="0.08s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.5;0.3;0.5" dur="0.08s" repeatCount="indefinite"/>
                    </path>
                    
                    <!-- å£°æ³¢æ‰©æ•£ (å¤šå±‚) -->
                    <path d="M100,30 Q90,55 100,80" fill="none" stroke="#42A5F5" stroke-width="3" opacity="0" stroke-linecap="round">
                        <animate attributeName="d" values="M100,30 Q90,55 100,80; M80,20 Q60,55 80,90; M60,10 Q30,55 60,100" dur="1.5s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.8;0.4;0" dur="1.5s" repeatCount="indefinite"/>
                    </path>
                    <path d="M200,30 Q210,55 200,80" fill="none" stroke="#42A5F5" stroke-width="3" opacity="0" stroke-linecap="round">
                        <animate attributeName="d" values="M200,30 Q210,55 200,80; M220,20 Q240,55 220,90; M240,10 Q270,55 240,100" dur="1.5s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.8;0.4;0" dur="1.5s" repeatCount="indefinite"/>
                    </path>
                    <!-- ç¬¬äºŒå±‚å£°æ³¢ -->
                    <path d="M105,35 Q95,55 105,75" fill="none" stroke="#64B5F6" stroke-width="2" opacity="0" stroke-linecap="round">
                        <animate attributeName="d" values="M105,35 Q95,55 105,75; M85,25 Q70,55 85,85; M65,15 Q40,55 65,95" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.6;0.3;0" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>
                    </path>
                    <path d="M195,35 Q205,55 195,75" fill="none" stroke="#64B5F6" stroke-width="2" opacity="0" stroke-linecap="round">
                        <animate attributeName="d" values="M195,35 Q205,55 195,75; M215,25 Q230,55 215,85; M235,15 Q260,55 235,95" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>
                        <animate attributeName="opacity" values="0.6;0.3;0" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>
                    </path>

                    <!-- æ ‡æ³¨çº¿ -->
                    <line x1="120" y1="40" x2="75" y2="40" stroke="#666" stroke-width="1" stroke-dasharray="3,2"/>
                    <text x="10" y="35" font-size="11" fill="#555" font-weight="bold">å­—æ¯</text>
                    <text x="10" y="48" font-size="10" fill="#777">=éŸ³è°ƒ</text>
                    
                    <line x1="180" y1="60" x2="225" y2="60" stroke="#666" stroke-width="1" stroke-dasharray="3,2"/>
                    <text x="230" y="58" font-size="11" fill="#555" font-weight="bold">æ•°å­—</text>
                    <text x="230" y="70" font-size="10" fill="#777">=é¢‘ç‡</text>
                    
                    <!-- éŸ³å‰æ ‡è¯† -->
                    <text x="150" y="125" text-anchor="middle" font-size="10" fill="white" font-weight="bold">C-256</text>
                </svg>
            </div>
        </div>

        <div class="knowledge-box">
            <h3>ğŸµ é‡ç‚¹3ï¼šæè¿°å£°éŸ³</h3>
            <p>ğŸ”Š <strong>é«˜/ä½</strong>ï¼šå°å­©(é«˜)ã€æˆäºº(ä½)ã€‚</p>
            <p>ğŸ“¢ <strong>å¼º/å¼±</strong>ï¼šé›·å£°(å¼º)ã€é›¨å£°(å¼±)ã€‚</p>
            <p>ğŸ¶ <strong>æ‚¦è€³/åˆºè€³</strong>ï¼šä¹æ›²(æ‚¦è€³)ã€å™ªéŸ³(åˆºè€³)ã€‚</p>
        </div>

        <button class="btn" onclick="startQuiz()">å¼€å§‹35é¢˜æŒ‘æˆ˜ï¼ğŸš€</button>
    </div>

    <!-- 2. é—¯å…³åŒº -->
    <div id="section-quiz" class="container section">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div style="text-align:right; font-size:0.9em; color:#888; margin-bottom:5px;">é¢˜ç›®ï¼š<span id="q-index">1</span> / 35</div>
        
        <div id="question-area"></div>
        <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â–¶</button>
    </div>

    <!-- 3. ç»“ç®—åŒº -->
    <div id="section-result" class="container section">
        <h1>ğŸ† é—¯å…³æˆç»©</h1>
        <div class="score-big"><span id="final-score">0</span><span style="font-size:0.4em">åˆ†</span></div>
        <p id="reward-text">æ­£åœ¨è®¡ç®—...</p>
        
        <div id="wrong-list" style="display:none;">
            <h3 style="color:#E57373; border-bottom:2px solid #FFEBEE; padding-bottom:10px;">âŒ é”™é¢˜æœ¬</h3>
            <!-- é”™é¢˜æ’å…¥åŒº -->
        </div>

        <button class="btn" onclick="location.reload()">ğŸ”„ é‡æ–°æŒ‘æˆ˜</button>
    </div>

    <script>
        // --- å³æ—¶åé¦ˆç³»ç»Ÿ ---
        const InstantFeedback = {
            audioCtx: null,
            encouragements: ['å¤ªæ£’äº†ï¼ç»§ç»­åŠ æ²¹ï¼ğŸŒŸ', 'ä½ çœŸèªæ˜ï¼ğŸ‘', 'å®Œå…¨æ­£ç¡®ï¼çœŸå‰å®³ï¼ğŸ¯', 'ç­”å¯¹äº†ï¼ä½ æ˜¯æœ€æ£’çš„ï¼â­', 'å¤ªä¼˜ç§€äº†ï¼ç»§ç»­ä¿æŒï¼ğŸ†', 'çœŸæ˜¯ä¸ªå°å¤©æ‰ï¼ğŸ’¡', 'å›ç­”å¾—éå¸¸å¥½ï¼ğŸ‘', 'ä½ æŒæ¡å¾—å¾ˆå¥½ï¼ğŸ“š'],
            hints: ['å†æƒ³æƒ³å“¦ï¼ä½ å¯ä»¥çš„ï¼ğŸ’ª', 'åˆ«ç°å¿ƒï¼Œå†è¯•ä¸€æ¬¡ï¼ğŸŒˆ', 'åŠ æ²¹ï¼ä»”ç»†çœ‹çœ‹é¢˜ç›®ï¼ğŸ‘€', 'æ²¡å…³ç³»ï¼Œç»§ç»­åŠªåŠ›ï¼ğŸ’«', 'å†çœ‹çœ‹çŸ¥è¯†ç‚¹å§ï¼ğŸ“–', 'ä¸è¦æ”¾å¼ƒï¼Œä½ èƒ½è¡Œï¼ğŸš€', 'æ€è€ƒä¸€ä¸‹ï¼Œä½ ä¸€å®šèƒ½æƒ³åˆ°ï¼ğŸ¤”', 'åŠ æ²¹ï¼ç›¸ä¿¡è‡ªå·±ï¼âœ¨'],
            
            init() { if (!this.audioCtx) this.audioCtx = new (window.AudioContext || window.webkitAudioContext)(); },
            
            playCorrectSound() {
                this.init(); if (this.audioCtx.state === 'suspended') this.audioCtx.resume();
                const notes = [523.25, 659.25, 783.99];
                notes.forEach((freq, i) => {
                    const osc = this.audioCtx.createOscillator(); const gain = this.audioCtx.createGain();
                    osc.connect(gain); gain.connect(this.audioCtx.destination);
                    const now = this.audioCtx.currentTime; const start = now + i * 0.1;
                    osc.frequency.value = freq; osc.type = 'sine';
                    gain.gain.setValueAtTime(0.15, start); gain.gain.exponentialRampToValueAtTime(0.01, start + 0.3);
                    osc.start(start); osc.stop(start + 0.3);
                });
            },
            
            playWrongSound() {
                this.init(); if (this.audioCtx.state === 'suspended') this.audioCtx.resume();
                const osc = this.audioCtx.createOscillator(); const gain = this.audioCtx.createGain();
                osc.connect(gain); gain.connect(this.audioCtx.destination);
                const now = this.audioCtx.currentTime;
                osc.frequency.setValueAtTime(300, now); osc.frequency.linearRampToValueAtTime(250, now + 0.2);
                osc.type = 'triangle';
                gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            },
            
            showConfetti() {
                const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE'];
                for (let i = 0; i < 30; i++) {
                    setTimeout(() => {
                        const c = document.createElement('div'); c.className = 'confetti';
                        c.style.cssText = `width: ${Math.random() * 10 + 5}px; height: ${Math.random() * 10 + 5}px; background: ${colors[Math.floor(Math.random() * colors.length)]}; left: ${Math.random() * 100}%; top: -20px; border-radius: ${Math.random() > 0.5 ? '50%' : '0'}; animation: confetti-fall ${Math.random() * 2 + 2}s linear forwards; transform: rotate(${Math.random() * 360}deg);`;
                        document.body.appendChild(c);
                        setTimeout(() => c.remove(), 4000);
                    }, i * 30);
                }
            },
            
            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `feedback-toast feedback-${type}`;
                toast.innerHTML = `<div class="toast-icon">${type === 'success' ? 'âœ“' : 'âœ—'}</div><div class="toast-message">${message}</div>`;
                document.body.appendChild(toast);
                setTimeout(() => toast.classList.add('show'), 10);
                setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 300); }, 2500);
            },
            
            onCorrect(element) {
                this.playCorrectSound(); this.showConfetti();
                const msg = this.encouragements[Math.floor(Math.random() * this.encouragements.length)];
                this.showToast(msg, 'success');
                if (element) { element.classList.add('correct-feedback'); setTimeout(() => element.classList.remove('correct-feedback'), 600); }
            },
            
            onWrong(element, hint = '') {
                this.playWrongSound();
                const msg = this.hints[Math.floor(Math.random() * this.hints.length)] + (hint ? `<br><small style="font-size:0.85em;">ğŸ’¡ ${hint}</small>` : '');
                this.showToast(msg, 'error');
                if (element) { element.classList.add('wrong-feedback'); setTimeout(() => element.classList.remove('wrong-feedback'), 500); }
            }
        };
        InstantFeedback.init();

        // --- é¢˜åº“é…ç½® (35é“é¢˜) ---
        const quizData = [
            { type: 'mcq', q: 'ä¸‹åˆ—å±äºè‡ªç„¶ç•Œçš„å£°éŸ³çš„æ˜¯ï¼Ÿ', opts: ['è¯»ä¹¦å£°', 'é›·å£°', 'æ±½è½¦å–‡å­'], a: 1, exp: 'è¯»ä¹¦å£°æ˜¯äººç±»æ´»åŠ¨ï¼Œé›·å£°æ˜¯è‡ªç„¶çš„ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—å±äºåŠ¨ç‰©å«å£°çš„æ˜¯ï¼Ÿ', opts: ['é£å£°', 'é©¬çš„å˜¶é¸£å£°', 'äºŒèƒ¡å£°'], a: 1, exp: 'é©¬å˜¶é¸£æ˜¯åŠ¨ç‰©çš„å£°éŸ³ã€‚' },
            { type: 'mcq', q: 'å±äºäººç±»ç”Ÿäº§ç”Ÿæ´»çš„å£°éŸ³æ˜¯ï¼Ÿ', opts: ['é¸Ÿå«', 'æœºå™¨è½°é¸£å£°', 'é›¨å£°'], a: 1, exp: 'æœºå™¨è½°é¸£æ˜¯äººç±»ç”Ÿäº§æ´»åŠ¨ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šé£å£°ã€é›¨å£°ã€é›·å£°éƒ½å±äºè‡ªç„¶ç•Œçš„å£°éŸ³ã€‚', a: 1, exp: 'æ­£ç¡®ã€‚' }, 
            { type: 'tf', q: 'åˆ¤æ–­ï¼šæ¼”å¥ä¹å™¨å‘å‡ºçš„å£°éŸ³å±äºè‡ªç„¶ç•Œçš„å£°éŸ³ã€‚', a: 0, exp: 'é”™è¯¯ã€‚ä¹å™¨å£°å±äºäººç±»ç”Ÿæ´»å£°éŸ³ã€‚' },
            { type: 'mcq', q: 'â€œå“—å•¦å•¦â€çš„æµæ°´å£°å±äºï¼Ÿ', opts: ['åŠ¨ç‰©å£°éŸ³', 'è‡ªç„¶ç•Œå£°éŸ³', 'äººç±»å£°éŸ³'], a: 1, exp: 'æµæ°´å£°å±äºè‡ªç„¶ç•Œã€‚' },
            { type: 'mcq', q: 'æ¸…æ™¨çš„è¯»ä¹¦å£°å±äºï¼Ÿ', opts: ['äººç±»ç”Ÿæ´»å£°éŸ³', 'åŠ¨ç‰©å£°éŸ³', 'è‡ªç„¶ç•Œå£°éŸ³'], a: 0, exp: 'è¯»ä¹¦å£°æ˜¯äººç±»å£°éŸ³ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šç‹—å«å£°ã€çŒ«å«å£°éƒ½å±äºåŠ¨ç‰©çš„å«å£°ã€‚', a: 1, exp: 'æ­£ç¡®ã€‚' },
            { type: 'mcq', q: 'ä¸‹åˆ—ä¸å±äºè‡ªç„¶ç•Œå£°éŸ³çš„æ˜¯ï¼Ÿ', opts: ['æµ·æµªå£°', 'é£æœºèµ·é£å£°', 'æš´é£é›¨å£°'], a: 1, exp: 'é£æœºå£°æ˜¯æœºå™¨å£°ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šæˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªå……æ»¡å£°éŸ³çš„ä¸–ç•Œé‡Œã€‚', a: 1, exp: 'æ­£ç¡®ã€‚' },

            { type: 'mcq', q: 'é€šå¸¸æˆ‘ä»¬ç”¨ä»€ä¹ˆè¯æ¥æè¿°é›·å£°ï¼Ÿ', opts: ['å¼±', 'å¼º', 'ä½'], a: 1, exp: 'é›·å£°å¾ˆå“ï¼Œæè¿°ä¸ºâ€œå¼ºâ€ã€‚' },
            { type: 'mcq', q: 'é€šå¸¸æˆ‘ä»¬ç”¨ä»€ä¹ˆè¯æ¥æè¿°è½»è½»çš„é›¨å£°ï¼Ÿ', opts: ['å¼º', 'åˆºè€³', 'å¼±'], a: 2, exp: 'å°é›¨å£°å¾ˆè½»ï¼Œæè¿°ä¸ºâ€œå¼±â€ã€‚' },
            { type: 'mcq', q: 'å°å­©çš„å£°éŸ³é€šå¸¸æ¯”æˆå¹´äººæ›´___ï¼Ÿ', opts: ['ä½', 'ç²—', 'é«˜'], a: 2, exp: 'å°å­©å£°éŸ³å°–ç»†ï¼Œå³â€œé«˜â€ã€‚' },
            { type: 'mcq', q: 'æˆå¹´äººçš„å£°éŸ³é€šå¸¸æ¯”å°å­©æ›´___ï¼Ÿ', opts: ['é«˜', 'ä½', 'å°–'], a: 1, exp: 'æˆäººå£°éŸ³ç²—çŠ·ï¼Œå³â€œä½â€ã€‚' },
            { type: 'mcq', q: 'é¸Ÿå«å£°å¬èµ·æ¥é€šå¸¸æ¯”è¾ƒ___ï¼Ÿ', opts: ['åˆºè€³', 'æ‚¦è€³', 'å˜ˆæ‚'], a: 1, exp: 'é¸Ÿå«å£°å¥½å¬ï¼Œå³â€œæ‚¦è€³â€ã€‚' },
            { type: 'mcq', q: 'æœºå™¨çš„è½°é¸£å£°å¬èµ·æ¥é€šå¸¸æ¯”è¾ƒ___ï¼Ÿ', opts: ['æ‚¦è€³', 'åˆºè€³', 'ä¼˜ç¾'], a: 1, exp: 'å™ªéŸ³é€šå¸¸æè¿°ä¸ºâ€œåˆºè€³â€ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šå£°éŸ³åªæœ‰é«˜ä½ä¹‹åˆ†ï¼Œæ²¡æœ‰å¼ºå¼±ä¹‹åˆ†ã€‚', a: 0, exp: 'é”™è¯¯ã€‚å£°éŸ³æ—¢æœ‰é«˜ä½ä¹Ÿæœ‰å¼ºå¼±ã€‚' },
            { type: 'fill', q: 'æè¿°å£°éŸ³å¯ä»¥ç”¨é«˜ã€ä½ã€å¼ºã€___ã€æ‚¦è€³ç­‰ã€‚', a: ['å¼±'], exp: 'å¼ºä¸å¼±æ˜¯ç›¸å¯¹çš„ã€‚' },
            { type: 'mcq', q: 'ç”¨åŠ›æ•²å‡»é¼“é¢ï¼Œå£°éŸ³ä¼šï¼Ÿ', opts: ['å¼±', 'å¼º', 'ä½'], a: 1, exp: 'ç”¨åŠ›å¤§ï¼ŒæŒ¯åŠ¨å¤§ï¼Œå£°éŸ³â€œå¼ºâ€ã€‚' },
            { type: 'mcq', q: 'è½»è½»æ‹¨åŠ¨ç´å¼¦ï¼Œå£°éŸ³ä¼šï¼Ÿ', opts: ['å¼±', 'å¼º', 'å°–'], a: 0, exp: 'ç”¨åŠ›å°ï¼Œå£°éŸ³â€œå¼±â€ã€‚' },

            { type: 'mcq', q: 'ä¹è°±ä¸­ï¼ŒéŸ³ç¬¦â€œ1â€ä»£è¡¨ï¼Ÿ', opts: ['Do', 'Re', 'Mi'], a: 0, exp: '1æ˜¯Doã€‚' },
            { type: 'mcq', q: 'ä¹è°±ä¸­ï¼ŒéŸ³ç¬¦â€œ3â€ä»£è¡¨ï¼Ÿ', opts: ['Do', 'Re', 'Mi'], a: 2, exp: '3æ˜¯Miã€‚' },
            { type: 'sort', q: 'æŒ‰å£°éŸ³**ä»é«˜åˆ°ä½**æ’åˆ—â€œ1ã€2ã€3â€ï¼š', opts: ['1, 2, 3', '3, 2, 1', '2, 3, 1'], a: 1, exp: '3(Mi)æœ€é«˜ï¼Œ1(Do)æœ€ä½ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šä¹è°±ä¸­çš„æ•°å­—è¶Šå¤§ï¼Œå£°éŸ³è¶Šä½ã€‚', a: 0, exp: 'é”™è¯¯ã€‚æ•°å­—è¶Šå¤§ï¼Œå£°éŸ³è¶Šé«˜ã€‚' },
            { type: 'fill', q: 'éŸ³ç¬¦â€œ1ã€2ã€3â€ä¸­ï¼Œå£°éŸ³æœ€ä½çš„æ˜¯æ•°å­—___ã€‚', a: ['1'], exp: '1(Do)æ˜¯æœ€ä½çš„ã€‚' },

            { type: 'fill', q: 'éŸ³å‰æ˜¯ç”¨æ¥è°ƒè¯•ä¹å™¨å’Œæµ‹è¯•___çš„ä»ªå™¨ã€‚', a: ['éŸ³é«˜', 'éŸ³è°ƒ'], exp: 'éŸ³å‰æµ‹è¯•éŸ³é«˜ã€‚' },
            { type: 'mcq', q: 'éŸ³å‰ä¸Šçš„å­—æ¯ä»£è¡¨ä»€ä¹ˆï¼Ÿ', opts: ['éŸ³è°ƒ', 'å‚å®¶', 'ä»·æ ¼'], a: 0, exp: 'å­—æ¯ä»£è¡¨éŸ³è°ƒ(å¦‚Cã€D)ã€‚' },
            { type: 'mcq', q: 'éŸ³å‰ä¸Šçš„æ•°å­—ä»£è¡¨ä»€ä¹ˆï¼Ÿ', opts: ['é‡é‡', 'é•¿åº¦', 'æ¯ç§’æŒ¯åŠ¨æ¬¡æ•°'], a: 2, exp: 'æ•°å­—ä»£è¡¨é¢‘ç‡(æŒ¯åŠ¨æ¬¡æ•°)ã€‚' },
            { type: 'mcq', q: 'éŸ³å‰â€œ256â€å’Œâ€œ512â€ï¼Œå“ªä¸ªå£°éŸ³é«˜ï¼Ÿ', opts: ['256', '512', 'ä¸€æ ·'], a: 1, exp: 'æ•°å­—è¶Šå¤§å£°éŸ³è¶Šé«˜ã€‚' },
            { type: 'tf', q: 'åˆ¤æ–­ï¼šè½»æ•²å’Œé‡æ•²éŸ³å‰ï¼Œå£°éŸ³é«˜ä½ä¸åŒã€‚', a: 0, exp: 'é”™è¯¯ã€‚åŒä¸€éŸ³å‰éŸ³é«˜ä¸å˜ï¼Œæ”¹å˜çš„æ˜¯å¼ºå¼±ã€‚' },

            { type: 'mcq', q: 'å£°éŸ³åˆ†ç±»ä¸åŒ…æ‹¬å“ªé¡¹ï¼Ÿ', opts: ['åŠ¨ç‰©å«å£°', 'å¤–æ˜Ÿäººå£°éŸ³', 'äººç±»æ´»åŠ¨å£°éŸ³'], a: 1, exp: 'è¯¾æœ¬åˆ†ä¸‰ç±»ï¼šè‡ªç„¶ã€åŠ¨ç‰©ã€äººç±»ã€‚' },
            { type: 'fill', q: 'é£å£°ã€___å£°ã€é›·å£°æ˜¯è‡ªç„¶ç•Œçš„å£°éŸ³ã€‚', a: ['é›¨', 'æ°´', 'æµª'], exp: 'é›¨å£°æ˜¯è‡ªç„¶çš„ã€‚' },
            { type: 'fill', q: 'æ­Œå£°ã€___å£°æ˜¯äººç±»æ´»åŠ¨çš„å£°éŸ³ã€‚', a: ['è¯»ä¹¦', 'è¯´è¯', 'ç¬‘'], exp: 'è¯»ä¹¦å£°æ˜¯äººç±»çš„ã€‚' },
            { type: 'mcq', q: 'è¦ä½¿éŸ³å‰å£°éŸ³å˜å¼ºï¼Œåº”è¯¥ï¼Ÿ', opts: ['æ¢å¤§éŸ³å‰', 'ç”¨åŠ›æ•²', 'æ‚ä½å®ƒ'], a: 1, exp: 'ç”¨åŠ›æ•²ï¼ŒæŒ¯åŠ¨å¹…åº¦å¤§ï¼Œå£°éŸ³å¼ºã€‚' },
            { type: 'mcq', q: 'å¬åˆ°åˆºè€³å™ªéŸ³æ—¶åº”è¯¥ï¼Ÿ', opts: ['å¤§å«', 'æ‚è€³æœµç¦»å¼€', 'å¬ç€ç©'], a: 1, exp: 'ä¿æŠ¤å¬åŠ›ï¼Œè¿œç¦»å™ªéŸ³ã€‚' }
        ];

        let currentQIndex = 0;
        let userScoreRaw = 0;
        let userMistakes = [];
        let selectedOption = null;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'correct') {
                osc.frequency.setValueAtTime(600, now);
                osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            } else if (type === 'wrong') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(200, now);
                osc.frequency.linearRampToValueAtTime(100, now + 0.2);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            } else if (type === 'click') {
                osc.frequency.value = 800;
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.05);
                osc.start(now); osc.stop(now + 0.05);
            }
        }

        function startQuiz() {
            document.getElementById('section-review').classList.remove('active');
            document.getElementById('section-quiz').classList.add('active');
            currentQIndex = 0; userScoreRaw = 0; userMistakes = [];
            renderQuestion();
        }

        function renderQuestion() {
            const qData = quizData[currentQIndex];
            const area = document.getElementById('question-area');
            const nextBtn = document.getElementById('nextBtn');
            
            document.getElementById('q-index').innerText = currentQIndex + 1;
            let pct = ((currentQIndex) / quizData.length) * 100;
            document.getElementById('progressBar').style.width = pct + "%";

            area.innerHTML = '';
            selectedOption = null;
            nextBtn.disabled = true; nextBtn.style.opacity = 0.5;

            const card = document.createElement('div');
            card.className = 'question-card';
            
            let typeText = qData.type === 'fill' ? "å¡«ç©ºé¢˜" : (qData.type === 'tf' ? "åˆ¤æ–­é¢˜" : "é€‰æ‹©é¢˜");
            
            const qTitle = document.createElement('div');
            qTitle.className = 'q-text';
            qTitle.innerHTML = `<span class="q-tag">${typeText}</span> ` + qData.q;
            card.appendChild(qTitle);

            if (qData.type === 'mcq' || qData.type === 'sort') {
                const grid = document.createElement('div');
                grid.className = 'options-grid';
                qData.opts.forEach((opt, idx) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-item';
                    btn.innerText = opt;
                    btn.onclick = () => selectOption(btn, idx);
                    grid.appendChild(btn);
                });
                card.appendChild(grid);
            } else if (qData.type === 'tf') {
                const grid = document.createElement('div');
                grid.className = 'options-grid';
                ['æ­£ç¡® (âˆš)', 'é”™è¯¯ (Ã—)'].forEach((txt, idx) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-item';
                    btn.innerText = txt;
                    let val = idx === 0 ? 1 : 0;
                    btn.onclick = () => selectOption(btn, val);
                    grid.appendChild(btn);
                });
                card.appendChild(grid);
            } else if (qData.type === 'fill') {
                const input = document.createElement('input');
                input.type = 'text'; input.className = 'fill-input';
                input.placeholder = 'åœ¨æ­¤è¾“å…¥ç­”æ¡ˆ';
                input.oninput = (e) => {
                    selectedOption = e.target.value.trim();
                    nextBtn.disabled = !selectedOption;
                    nextBtn.style.opacity = selectedOption ? 1 : 0.5;
                };
                // æ·»åŠ å¤±ç„¦å³æ—¶åé¦ˆ
                input.onblur = () => {
                    if (selectedOption) {
                        const isCorrect = qData.a.some(ans => selectedOption.includes(ans));
                        setTimeout(() => {
                            if (isCorrect) {
                                InstantFeedback.onCorrect(input);
                            } else {
                                InstantFeedback.onWrong(input, qData.exp);
                            }
                        }, 200);
                    }
                };
                card.appendChild(input);
            }
            area.appendChild(card);
        }

        function selectOption(el, val) {
            playSound('click');
            
            // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.option-item').forEach(d => {
                d.classList.remove('selected', 'correct-feedback', 'wrong-feedback');
            });
            el.classList.add('selected');
            selectedOption = val;
            
            // ç«‹å³æ£€æŸ¥ç­”æ¡ˆå¹¶ç»™å‡ºåé¦ˆ
            const qData = quizData[currentQIndex];
            let isCorrect = false;
            
            if (qData.type === 'fill') {
                if (qData.a.some(ans => val.includes(ans))) isCorrect = true;
            } else {
                if (val === qData.a) isCorrect = true;
            }
            
            // å»¶è¿Ÿåé¦ˆï¼Œè®©ç”¨æˆ·çœ‹åˆ°é€‰ä¸­æ•ˆæœ
            setTimeout(() => {
                if (isCorrect) {
                    InstantFeedback.onCorrect(el);
                } else {
                    InstantFeedback.onWrong(el, qData.exp);
                }
            }, 200);
            
            // å¯ç”¨ä¸‹ä¸€é¢˜æŒ‰é’®
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('nextBtn').style.opacity = 1;
        }

        function nextQuestion() {
            const qData = quizData[currentQIndex];
            let isCorrect = false;

            if (qData.type === 'fill') {
                if (qData.a.some(ans => selectedOption.includes(ans))) isCorrect = true;
            } else {
                if (selectedOption === qData.a) isCorrect = true;
            }

            if (isCorrect) {
                userScoreRaw++;
                playSound('correct');
            } else {
                playSound('wrong');
                let myAnsStr = selectedOption;
                if(qData.type === 'tf') myAnsStr = selectedOption === 1 ? "æ­£ç¡®" : "é”™è¯¯";
                if(qData.type === 'mcq' && typeof selectedOption === 'number') myAnsStr = qData.opts[selectedOption];
                
                userMistakes.push({
                    q: qData.q,
                    my: myAnsStr,
                    right: (qData.type === 'tf' ? (qData.a===1?'æ­£ç¡®':'é”™è¯¯') : (qData.type === 'mcq' ? qData.opts[qData.a] : qData.a.join('/'))),
                    exp: qData.exp
                });
            }

            currentQIndex++;
            if (currentQIndex < quizData.length) renderQuestion();
            else showResults();
        }

        function showResults() {
            document.getElementById('section-quiz').classList.remove('active');
            document.getElementById('section-result').classList.add('active');
            
            let finalScore = Math.round((userScoreRaw / quizData.length) * 100);
            let temp = 0;
            const scoreEl = document.getElementById('final-score');
            const timer = setInterval(() => {
                if(temp >= finalScore) { clearInterval(timer); scoreEl.innerText = finalScore; }
                else { temp++; scoreEl.innerText = temp; }
            }, 20);

            const rewardText = document.getElementById('reward-text');
            if(finalScore === 100) rewardText.innerText = "ğŸ‰ æ»¡åˆ†ï¼ä½ æ˜¯ç§‘å­¦å°åšå£«ï¼";
            else if(finalScore >= 80) rewardText.innerText = "ğŸŒŸ å¾ˆæ£’ï¼ç»§ç»­ä¿æŒï¼";
            else rewardText.innerText = "ğŸ’ª åŠ æ²¹ï¼çœ‹çœ‹é”™é¢˜è§£æï¼";

            const list = document.getElementById('wrong-list');
            if(userMistakes.length > 0) {
                list.style.display = 'block';
                let html = '';
                userMistakes.forEach((m, i) => {
                    html += `<div class="wrong-card"><div style="font-weight:bold;">${i+1}. ${m.q}</div><div style="margin:5px 0; font-size:0.9em;"><span style="color:#D32F2F">ä½ çš„ç­”æ¡ˆï¼š${m.my || 'æœªå¡«'}</span><br><span style="color:#388E3C; font-weight:bold;">æ­£ç¡®ç­”æ¡ˆï¼š${m.right}</span></div><div style="font-size:0.8em; color:#555;">ğŸ’¡ ${m.exp}</div></div>`;
                });
                list.innerHTML += html;
            }
        }
    </script>
</body>
</html>